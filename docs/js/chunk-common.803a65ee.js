"use strict";(globalThis["webpackChunkmetaforcehome"]=globalThis["webpackChunkmetaforcehome"]||[]).push([[64],{8853:(e,t,i)=>{i.d(t,{Fv:()=>o,LS:()=>n,PQ:()=>a,WV:()=>s,_E:()=>r,dP:()=>l});const a="/metaforce/verification-code/request",s="/metaforce/verification-code/verify",o="/metaforce/customer",n="/metaforce/case",l="/metaforce/customer-related-list",r="/paddle/subscription/cancel"},5869:(e,t,i)=>{i.d(t,{$v:()=>l,cB:()=>n});var a=i(5054),s=i(6827);i(3382);let o;function n(e,t={}){return r(),o=s.Z.create({group:!1,message:`<div class="text-wrap">${e}</div>`,classes:"q-electron-drag--exception",html:!0,multiLine:!1,icon:"error",position:"top",color:"red-6",actions:[{icon:"content_copy",id:"error_copy_btn",dense:!0,size:"12px",square:!0,stretch:!0,color:"white",handler:async()=>{let t=document.createElement("DIV");t.innerHTML=e,await(0,a.Z)(t.textContent||t.innerText||""),document.querySelector("#error_copy_btn .q-btn__content i.q-icon").textContent="done"}},{icon:"close",dense:!0,size:"12px",square:!0,stretch:!0,color:t.closeColor||"white",handler:()=>o()}],...t}),o}function l(e,t={}){return r(),o=s.Z.create({group:!1,message:e,classes:"q-electron-drag--exception",html:!0,icon:"notifications",position:"top",color:"positive",actions:[{icon:"close",dense:!0,square:!0,stretch:!0,color:t.closeColor||"white",handler:()=>o()}],...t}),o}function r(){o&&(o(),o=null)}},4329:(e,t,i)=>{i.d(t,{U2:()=>n,gz:()=>r,v_:()=>l});var a=i(9981),s=i.n(a);s().defaults.baseURL="https://quasar-metaforce-dev-ed.my.salesforce-sites.com/services/apexrest/easymeta",s().defaults.timeout=6e5,s().defaults.headers.post["Content-Type"]="application/json;charset=UTF-8",s().defaults.headers.domain="https://quasar-metaforce-dev-ed.my.salesforce-sites.com";const o=e=>s().request(e).then((e=>e.data)).catch((e=>("object"===typeof e&&(delete e["config"],delete e["headers"],delete e["request"]),Promise.reject(e))));function n(e,t={},i={}){return o({method:"get",url:e,headers:t,...i})}function l(e,t,i={},a={}){return o({method:"post",url:e,data:t,headers:i,...a})}function r(e,t,i={}){return o({method:"put",url:e,data:t,headers:i})}},158:(e,t,i)=>{i.d(t,{R:()=>o,n:()=>s});var a=i(3703);const s={getCustomer(){return a.Z.getItem("customer")},setCustomer(e){return a.Z.set("customer",e)},getLoginToken(){return a.Z.getItem("token")},setLoginToken(e){return a.Z.set("token",e)},clearLoginCache(){a.Z.remove("customer"),a.Z.remove("token")}};async function o(e=3e3){await new Promise((t=>setTimeout(t,e)))}},603:(e,t,i)=>{i.d(t,{Z:()=>V});var a=i(9835),s=i(6970);const o={class:"q-ma-md"},n={class:"q-my-lg text-center text-h5"},l={class:"text-center q-mt-lg"},r={class:"row justify-center",style:{width:"150px"}};function c(e,t,i,c,d,u){const m=(0,a.up)("q-tab"),p=(0,a.up)("q-tabs"),h=(0,a.up)("q-icon"),f=(0,a.up)("q-input"),g=(0,a.up)("q-btn"),b=(0,a.up)("q-item-label"),w=(0,a.up)("q-item-section"),y=(0,a.up)("q-item"),v=(0,a.up)("q-spinner-bars"),k=(0,a.up)("q-form");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(p,{modelValue:d.currentTabName,"onUpdate:modelValue":t[0]||(t[0]=e=>d.currentTabName=e),align:"left","active-bg-color":"primary","active-color":"white","indicator-color":"primary",class:"bg-grey-2","inline-label":"","no-caps":""},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{name:"SignInTab",icon:"home",label:"Sign In",class:"col"}),(0,a.Wm)(m,{name:"SignUpTab",icon:"add_circle_outline",label:"Sign Up",class:"col"})])),_:1},8,["modelValue"]),(0,a._)("div",o,[(0,a.Wm)(k,{ref:"formCmp"},{default:(0,a.w5)((()=>[(0,a._)("div",n,(0,s.zw)(u.isSignIn?"Welcome back!":"Create your account"),1),u.isSignIn?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[(0,a.Wm)(f,{modelValue:d.form.firstname,"onUpdate:modelValue":t[1]||(t[1]=e=>d.form.firstname=e),label:"First Name",class:"q-mb-md",rules:d.nameRules,"lazy-rules":"ondemand",autofocus:"",outlined:"","hide-bottom-space":""},{prepend:(0,a.w5)((()=>[(0,a.Wm)(h,{name:"person"})])),_:1},8,["modelValue","rules"]),(0,a.Wm)(f,{modelValue:d.form.lastname,"onUpdate:modelValue":t[2]||(t[2]=e=>d.form.lastname=e),label:"Last Name",class:"q-mb-md",rules:d.nameRules,"lazy-rules":"ondemand",outlined:"","hide-bottom-space":""},{prepend:(0,a.w5)((()=>[(0,a.Wm)(h,{name:"person"})])),_:1},8,["modelValue","rules"])],64)),(0,a.Wm)(f,{modelValue:d.form.email,"onUpdate:modelValue":t[3]||(t[3]=e=>d.form.email=e),label:"Email address",type:"email",class:"q-mb-md",rules:d.emailRules,"lazy-rules":"ondemand",autofocus:"",outlined:"","hide-bottom-space":""},{prepend:(0,a.w5)((()=>[(0,a.Wm)(h,{name:"email"})])),_:1},8,["modelValue","rules"]),(0,a.Wm)(f,{modelValue:d.form.verificationCode,"onUpdate:modelValue":t[4]||(t[4]=e=>d.form.verificationCode=e),label:"Verification Code","input-class":"verification-code-input",type:"number",outlined:"","hide-bottom-space":""},{prepend:(0,a.w5)((()=>[(0,a.Wm)(h,{name:"pin"})])),after:(0,a.w5)((()=>[(0,a.Wm)(g,{onClick:u.requestVerificationCode,disabled:"Draft"!=d.statusOfRequestCode,loading:"Sending"==d.statusOfRequestCode,class:"bg-primary text-white",style:{height:"55px"},flat:"","no-caps":""},{default:(0,a.w5)((()=>[(0,a._)("div",null,(0,s.zw)("Sent"==d.statusOfRequestCode?"Sent":"Request Code"),1)])),_:1},8,["onClick","disabled","loading"])])),_:1},8,["modelValue"]),"Sent"==d.statusOfRequestCode?((0,a.wg)(),(0,a.j4)(y,{key:1,class:"text-positive q-pl-none"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(b,null,{default:(0,a.w5)((()=>[(0,a.Uk)("The verification code has been sent to "+(0,s.zw)(d.form.email)+".",1)])),_:1}),(0,a.Wm)(b,{caption:""},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{name:"help_outline"}),(0,a.Uk)(" Didn't receive a code? Resend the code in "+(0,s.zw)(d.countDown)+" seconds. ",1)])),_:1})])),_:1})])),_:1})):(0,a.kq)("",!0),(0,a._)("div",l,[(0,a.Wm)(g,{loading:d.isSubmitting,onClick:u.submitForm,color:"primary",class:"bg-primary text-white","no-caps":"",flat:""},{loading:(0,a.w5)((()=>[(0,a.Wm)(v,{size:"xs"})])),default:(0,a.w5)((()=>[(0,a._)("div",r,[(0,a._)("span",null,(0,s.zw)(u.isSignIn?"Sign In":"Sign Up"),1),(0,a.Wm)(h,{name:"arrow_circle_right",class:"q-pl-md"})])])),_:1},8,["loading","onClick"])])])),_:1},512)])])}var d=i(4329),u=i(5869),m=i(8853),p=i(158);const h={data(){return{currentTabName:"SignInTab",countDown:60,countDownTimer:null,isSubmitting:!1,form:{firstname:"",lastname:"",email:"",verificationCode:""},statusOfRequestCode:"Draft",nameRules:[e=>e&&e.length>0||"Required"],emailRules:[e=>{if(e){const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return e&&t.test(e)||"Invalid Email Address"}return"Required"}]}},computed:{isSignIn(){return"SignInTab"==this.currentTabName}},methods:{async requestVerificationCode(){let e=await this.$refs.formCmp.validate();if(e)try{this.statusOfRequestCode="Sending",this.form.verificationCode="";let e=await(0,d.v_)(m.PQ,{firstname:this.form.firstname,lastname:this.form.lastname,email:this.form.email});e.isSuccess?(this.statusOfRequestCode="Sent",this.startCountDown()):(this.statusOfRequestCode="Draft",(0,u.cB)(e.message))}catch(t){this.statusOfRequestCode="Draft"}},startCountDown(){this.countDown=60,this.countDownTimer=setInterval((()=>{this.countDown--,this.countDown<=0&&(this.statusOfRequestCode="Draft",clearInterval(this.countDownTimer))}),1e3)},async submitForm(){if(!this.form.verificationCode.trim())return void(0,u.cB)("Verification code is missing!");let e=await this.$refs.formCmp.validate();if(e)try{this.isSubmitting=!0;let e=await(0,d.v_)(m.WV,{firstname:this.form.firstname,lastname:this.form.lastname,email:this.form.email,verificationCode:this.form.verificationCode});e.isSuccess?(p.n.setLoginToken(e.message),p.n.setCustomer(e.customer),this.$emit("onLoginSuccess",{token:e.message,customer:e.customer})):(0,u.cB)(e.message)}catch(t){(0,u.cB)(t)}finally{this.isSubmitting=!1}}}};var f=i(1639),g=i(2230),b=i(900),w=i(8326),y=i(9897),v=i(2857),k=i(8879),_=i(490),q=i(1233),C=i(3115),W=i(3382),S=i(9984),I=i.n(S);const x=(0,f.Z)(h,[["render",c]]),V=x;I()(h,"components",{QTabs:g.Z,QTab:b.Z,QForm:w.Z,QInput:y.Z,QIcon:v.Z,QBtn:k.Z,QItem:_.Z,QItemSection:q.Z,QItemLabel:C.Z,QSpinnerBars:W.Z})},3240:(e,t,i)=>{i.r(t),i.d(t,{default:()=>U});var a=i(9835),s=i(6970);const o=e=>((0,a.dD)("data-v-5ddab0d4"),e=e(),(0,a.Cn)(),e),n={class:"q-py-lg text-center bg-primary text-white"},l=(0,a.Uk)("Metaforce Subscriptions"),r=(0,a.Uk)("Choose a subscription plan"),c=(0,a.Uk)("During the free trial or the subscription, you can cancel the subscription at any time."),d={key:0,class:"text-center q-my-xl"},u=o((()=>(0,a._)("div",{class:"q-mt-md"},"Loading Subscription Plans ...",-1))),m=o((()=>(0,a._)("div",{class:"checkout-container"},null,-1))),p=o((()=>(0,a._)("div",{class:"q-mt-md text-primary text-h6"}," Verifying your subscription... ",-1)));function h(e,t,i,o,h,f){const g=(0,a.up)("q-item-label"),b=(0,a.up)("q-item-section"),w=(0,a.up)("q-item"),y=(0,a.up)("q-spinner-bars"),v=(0,a.up)("q-radio"),k=(0,a.up)("q-list"),_=(0,a.up)("q-btn"),q=(0,a.up)("q-inner-loading");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",n,[(0,a.Wm)(g,{class:"text-h4"},{default:(0,a.w5)((()=>[l])),_:1})]),h.isCheckoutLoaded?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(k,{key:0,class:"q-mx-xl q-mt-md"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{class:"q-pl-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{class:"text-body1",style:{"font-size":"25px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[r])),_:1}),(0,a.Wm)(g,{caption:""},{default:(0,a.w5)((()=>[c])),_:1})])),_:1})])),_:1}),h.isPricesLoading?((0,a.wg)(),(0,a.iD)("div",d,[(0,a.Wm)(y,{size:"md",color:"primary"}),u])):((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[(0,a.Wm)(k,{bordered:"",separator:"",padding:""},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(h.paddlePrices,((e,i)=>((0,a.wg)(),(0,a.j4)(w,{key:i,tag:"label",class:(0,s.C_)(e.id==h.selectedPriceId?"text-primary text-bold":""),clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{modelValue:h.selectedPriceId,"onUpdate:modelValue":t[0]||(t[0]=e=>h.selectedPriceId=e),val:e.id},null,8,["modelValue","val"])])),_:2},1024),(0,a.Wm)(b,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.name),1)])),_:2},1024),(0,a.Wm)(g,{class:(0,s.C_)(e.id==h.selectedPriceId?"text-primary":""),caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.description),1)])),_:2},1032,["class"])])),_:2},1024),(0,a.Wm)(b,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.total),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class"])))),128))])),_:1}),(0,a.Wm)(w,{class:"q-pa-none q-my-md"},{default:(0,a.w5)((()=>[(0,a.Wm)(b,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,{disabled:!f.isPaddleInitialized,loading:h.isCheckoutLoading,onClick:f.subscribeNow,label:"Subscribe Now",color:"white",class:"bg-positive",style:{"min-height":"50px"},flat:"",stretch:"","no-caps":""},null,8,["disabled","loading","onClick"])])),_:1})])),_:1}),i.isInApp?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(w,{key:0,class:"q-pa-none q-mt-md"},{default:(0,a.w5)((()=>[(0,a.Wm)(b,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,{label:"Back",style:{"min-height":"50px"},onClick:f.goBack,flat:"",stretch:"","no-caps":""},null,8,["onClick"])])),_:1})])),_:1}))],64))])),_:1})),(0,a._)("div",{style:(0,s.j5)("display:"+(h.isCheckoutLoaded?"block":"none"))},[m,(0,a.Wm)(k,{class:"q-mx-xl q-my-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{class:"q-pa-none q-mt-md"},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{class:"col-2"}),(0,a.Wm)(b,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,{label:"Cancel",style:{"min-height":"50px"},onClick:f.clearCheckout,stretch:"","no-caps":""},null,8,["onClick"])])),_:1}),(0,a.Wm)(b,{class:"col-2"})])),_:1})])),_:1})],4),(0,a.Wm)(q,{showing:h.isVerifyingSubs,style:{"background-color":"rgba(255,255,255,0.8)"},color:"primary",label:"Please wait..."},{default:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a.Wm)(y,{color:"primary",size:"md"})]),p])),_:1},8,["showing"])],64)}i(6727),i(9665);var f=i(9261),g=i(5869),b=i(158),w=i(4329),y=i(8853);const v="pri_01jta1x1vj0r3q7ft9byvyam2t",k="live_d4d9aa787e98046fa2cddeaa266",_="pri_01jtqz2p1q9bxnzgkqng50fehb",q={items:[{quantity:1,priceId:_}]},C={emits:["onCheckoutVerified"],data(){return{paddle:null,selectedPriceId:v,paddlePrices:[],isPricesLoading:!1,isCheckoutLoading:!1,isCheckoutLoaded:!1,isCheckoutCompleted:!1,isVerifyingSubs:!1,counterOfVerify:0}},props:{isInApp:{type:Boolean,default:!1},token:{type:String}},computed:{isPaddleInitialized(){var e;return null===(e=this.paddle)||void 0===e?void 0:e.Initialized}},methods:{paddleEventCallback(e){"checkout.loaded"==e.name?(this.isCheckoutLoading=!1,this.isCheckoutLoaded=!0):"checkout.completed"==e.name?(this.isCheckoutCompleted=!0,this.isVerifyingSubs=!0,this.verifySubscription()):"checkout.warning"==e.name||e.name},async initializePaddle(){try{this.isPricesLoading=!0,this.paddle=await(0,f.J4)({environment:"production",token:k,checkout:{settings:{theme:"light",frameTarget:"checkout-container",displayMode:"inline",frameInitialHeight:450,frameStyle:"background-color:white;width:100%;",variant:"one-page"}},eventCallback:this.paddleEventCallback}),this.paddle.Initialized?this.loadPaddlePrices():this.isPricesLoading=!1}catch(e){console.error("Initialization error:",e)}},async loadPaddlePrices(){const e=await Paddle.PricePreview(q);this.paddlePrices=e.data.details.lineItems.map((e=>{let{id:t,name:i,description:a}=e.price,{discount:s,tax:o,total:n}=e.formattedTotals;return{id:t,name:i,description:a,discount:s,tax:o,total:n}})),this.isPricesLoading=!1},async getCustomer(){return await(0,w.U2)(`${y.Fv}?token=${this.token}`)},async subscribeNow(){var e;let t=b.n.getCustomer();if(this.isInApp&&(t=await this.getCustomer(),console.log(t)),null!==(e=t)&&void 0!==e&&e.easymeta__Email__c){if(this.isPaddleInitialized)try{this.isCheckoutLoading=!0,this.paddle.Checkout.open({items:[{priceId:this.selectedPriceId,quantity:1}],customer:{email:t.easymeta__Email__c}})}catch(i){console.error(`Checkout error: ${i.message}`)}}else(0,g.cB)("Please log in with your email, then continue to subscribe.")},async verifySubscription(){let e=await this.getCustomer();if(e.Id){var t;let i=(null===(t=e.easymeta__PaddleSubscriptions__r)||void 0===t?void 0:t.records)||[],a=i.filter((e=>["active","trialing"].includes(e.easymeta__Status__c))).length>0;a?(this.clearCheckout(),this.isVerifyingSubs=!1,this.isInApp?this.$emit("onCheckoutVerified",e):this.$route.push("/customer")):this.counterOfVerify>=10?(this.clearCheckout(),this.isVerifyingSubs=!1):(await(0,b.R)(1e3),this.counterOfVerify++,await this.verifySubscription())}},goBack(){this.$router.go(-1)},clearCheckout(){document.querySelector("div.checkout-container").innerHTML="",this.isCheckoutLoaded=!1}},async mounted(){let e=this.$route.query.token;(null===e||void 0===e?void 0:e.length)>30&&(this.loginToken=e,b.n.setLoginToken(e)),this.paddle||this.initializePaddle()}};var W=i(1639),S=i(3115),I=i(3246),x=i(490),V=i(1233),P=i(3382),L=i(1480),Z=i(8879),T=i(854),z=i(9984),D=i.n(z);const R=(0,W.Z)(C,[["render",h],["__scopeId","data-v-5ddab0d4"]]),U=R;D()(C,"components",{QItemLabel:S.Z,QList:I.Z,QItem:x.Z,QItemSection:V.Z,QSpinnerBars:P.Z,QRadio:L.Z,QBtn:Z.Z,QInnerLoading:T.Z})}}]);