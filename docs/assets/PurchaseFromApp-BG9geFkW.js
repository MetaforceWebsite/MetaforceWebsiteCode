import{Q as u}from"./QItemLabel-CycwUEQJ.js";import{_ as m,aE as p,aF as h,S as i,K as o,P as s,T as C,N as l,L as f,R as n,X as k,Q as _,V as g,aK as y,aL as E,H as c}from"./index-UmDEmY2c.js";import{i as v,C as a}from"./index.esm-B0dn8-SH.js";const I={emits:["onCheckoutVerified"],data(){return{paddle:null,selectedPriceId:null,isInvalidRequest:!1,counterOfVerify:0,isCheckoutCompleted:!1}},computed:{...h(c,["customer","hasActiveSubscription"])},methods:{...p(c,["updateLoginToken"]),closeWindow(){window.close()},async paddleEventCallback(e){console.log(e),e.name==a.CHECKOUT_LOADED||(e.name==a.CHECKOUT_COMPLETED?(console.log("posted subscription message"),this.isCheckoutCompleted=!0):e.name==a.CHECKOUT_ERROR?console.log("checkout error"):e.name==a.CHECKOUT_FAILED&&console.log("checkout failed"))},async initializePaddlePricings(){try{if(this.paddle=await v({environment:E?"sandbox":"production",token:y,checkout:{settings:{theme:"light",displayMode:"inline",frameTarget:"checkout-container",frameInitialHeight:"500",frameStyle:"background-color:white;width:100%;"}},eventCallback:this.paddleEventCallback}),this.paddle.Initialized)try{this.paddle.Checkout.open({items:[{priceId:this.selectedPriceId,quantity:1}],customer:{email:this.customer?.easymeta__Email__c}})}catch(e){console.error(`Checkout error: ${e.message}`)}}catch(e){console.error("Initialization error:",e)}}},async mounted(){let{pid:e,token:t}=this.$route.query;t&&this.updateLoginToken(t),e!=null?(this.selectedPriceId=e,this.initializePaddlePricings()):this.isInvalidRequest=!0}},b={class:"q-py-lg text-center bg-primary text-white"},x={key:0,class:"text-center",style:{"margin-top":"100px"}},P={class:"text-positive"},w={key:1,class:"checkout-container"},T={key:2,class:"row text-h4 text-grey justify-center items-center",style:{height:"calc(80vh - 89px)"}};function N(e,t,L,O,r,d){return o(),i(g,null,[s("div",b,[l(u,{class:"text-h4"},{default:f(()=>t[0]||(t[0]=[n("Metaforce Subscriptions")])),_:1})]),r.isCheckoutCompleted?(o(),i("div",x,[s("div",P,[l(k,{size:"7rem",color:"positive",name:"verified"}),t[1]||(t[1]=s("div",{class:"text-h5 q-py-lg text-bold"},[n(" Congrats! "),s("br"),n("You have subscribed Metaforce successfully. ")],-1))]),t[2]||(t[2]=s("br",null,null,-1)),t[3]||(t[3]=s("div",null,"Please close the window to contine.",-1)),l(_,{label:"Close",onClick:d.closeWindow,class:"q-mt-md",style:{width:"200px"},"no-caps":"",outline:""},null,8,["onClick"])])):(o(),i("div",w)),r.isInvalidRequest?(o(),i("div",T,t[4]||(t[4]=[s("span",null,"Invalid Subscription Request!",-1)]))):C("",!0)],64)}const R=m(I,[["render",N],["__scopeId","data-v-d3e591bc"]]);export{R as default};
