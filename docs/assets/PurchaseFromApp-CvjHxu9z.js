import{Q as d}from"./QItemLabel-Bv_IoURG.js";import{_ as u,aG as m,S as i,K as o,P as s,T as p,N as a,L as h,R as n,X as C,Q as f,V as _,aY as k,aZ as y,H as g}from"./index-BgjpCi4j.js";import{i as E,C as l}from"./index.esm-B0dn8-SH.js";const v={emits:["onCheckoutVerified"],data(){return{paddle:null,selectedPriceId:null,isInvalidRequest:!1,counterOfVerify:0,isCheckoutCompleted:!1}},computed:{...m(g,["customer","hasActiveSubscription"])},methods:{closeWindow(){window.close()},async paddleEventCallback(e){console.log(e),e.name==l.CHECKOUT_LOADED||(e.name==l.CHECKOUT_COMPLETED?(console.log("posted subscription message"),this.isCheckoutCompleted=!0):e.name==l.CHECKOUT_ERROR?console.log("checkout error"):e.name==l.CHECKOUT_FAILED&&console.log("checkout failed"))},async initializePaddlePricings(){try{if(this.paddle=await E({environment:y?"sandbox":"production",token:k,checkout:{settings:{theme:"light",displayMode:"inline",frameTarget:"checkout-container",frameInitialHeight:"500",frameStyle:"background-color:white;width:100%;"}},eventCallback:this.paddleEventCallback}),this.paddle.Initialized)try{this.paddle.Checkout.open({items:[{priceId:this.selectedPriceId,quantity:1}],customer:{email:this.customer?.easymeta__Email__c}})}catch(e){console.error(`Checkout error: ${e.message}`)}}catch(e){console.error("Initialization error:",e)}}},async mounted(){let{pid:e}=this.$route.query;e!=null?(this.selectedPriceId=e,this.initializePaddlePricings()):this.isInvalidRequest=!0}},I={class:"q-py-lg text-center bg-primary text-white"},b={key:0,class:"text-center",style:{"margin-top":"100px"}},x={class:"text-positive"},P={key:1,class:"checkout-container"},w={key:2,class:"row text-h4 text-grey justify-center items-center",style:{height:"calc(80vh - 89px)"}};function N(e,t,O,T,r,c){return o(),i(_,null,[s("div",I,[a(d,{class:"text-h4"},{default:h(()=>t[0]||(t[0]=[n("Metaforce Subscriptions")])),_:1})]),r.isCheckoutCompleted?(o(),i("div",b,[s("div",x,[a(C,{size:"7rem",color:"positive",name:"verified"}),t[1]||(t[1]=s("div",{class:"text-h5 q-py-lg text-bold"},[n(" Congrats! "),s("br"),n("You have subscribed Metaforce successfully. ")],-1))]),t[2]||(t[2]=s("br",null,null,-1)),t[3]||(t[3]=s("div",null,"Please close the window to contine.",-1)),a(f,{label:"Close",onClick:c.closeWindow,class:"q-mt-md",style:{width:"200px"},"no-caps":"",outline:""},null,8,["onClick"])])):(o(),i("div",P)),r.isInvalidRequest?(o(),i("div",w,t[4]||(t[4]=[s("span",null,"Invalid Subscription Request!",-1)]))):p("",!0)],64)}const S=u(v,[["render",N],["__scopeId","data-v-ed6afeeb"]]);export{S as default};
