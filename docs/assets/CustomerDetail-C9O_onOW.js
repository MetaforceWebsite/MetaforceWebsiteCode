import{c as T,C as L,D as F,g as I,b as M,f as N,j as P,_ as k,G as O,au as Y,J as m,K as n,L as l,N as t,O as C,X as c,R as f,P as s,W as p,Q as b,Y as R,T as Q,av as G,aw as H,Z as D,S as _,ax as S,V as q,a8 as A,U as u,H as v}from"./index-CZc2_RU5.js";import{n as j,c as h,d as y,Q as V,f as J}from"./notify-ok1iTEyB.js";import{b as U}from"./QItem-ClERZK4I.js";import{Q as E}from"./QEditor-BtrWD6NC.js";import{f as K}from"./utils-1wdjvRJP.js";import"./selection-Ttso33-E.js";const W=["horizontal","vertical","cell","none"],B=T({name:"QMarkupTable",props:{...L,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,wrapCells:Boolean,separator:{type:String,default:"horizontal",validator:a=>W.includes(a)}},setup(a,{slots:e}){const g=I(),w=F(a,g.proxy.$q),o=M(()=>`q-markup-table q-table__container q-table__card q-table--${a.separator}-separator`+(w.value===!0?" q-table--dark q-table__card--dark q-dark":"")+(a.dense===!0?" q-table--dense":"")+(a.flat===!0?" q-table--flat":"")+(a.bordered===!0?" q-table--bordered":"")+(a.square===!0?" q-table--square":"")+(a.wrapCells===!1?" q-table--no-wrap":""));return()=>N("div",{class:o.value},[N("table",{class:"q-table"},P(e.default))])}}),X={data(){return{isShow:!1,newCase:{subject:"",body:""},isSaving:!1,nameRules:[a=>a&&a.length>0||"Required"]}},props:{customer:{type:Object,required:!0}},methods:{show(){this.isShow=!0},async submitCase(){if(await this.$refs.caseFormCmp.validate()){this.isSaving=!0;let e=await O(Y,{customerId:this.customer.Id,subject:this.newCase.subject,body:this.newCase.body});e.isSuccess?(this.$emit("onSubmitted"),this.isShow=!1):j(e.message),this.isSaving=!1}}}},Z={class:"text-center q-mt-lg"};function $(a,e,g,w,o,r){return n(),m(R,{modelValue:o.isShow,"onUpdate:modelValue":e[2]||(e[2]=d=>o.isShow=d)},{default:l(()=>[t(C,{style:{width:"100%"}},{default:l(()=>[t(h,{class:"bg-primary text-white"},{default:l(()=>[t(c,{name:"contact_support",size:"md"}),t(y,null,{default:l(()=>e[3]||(e[3]=[f("Submit A Case")])),_:1})]),_:1}),t(V,{ref:"caseFormCmp",class:"q-ma-md"},{default:l(()=>[t(p,{modelValue:o.newCase.subject,"onUpdate:modelValue":e[0]||(e[0]=d=>o.newCase.subject=d),label:"Subject",class:"q-mb-md",rules:o.nameRules,"lazy-rules":"ondemand",outlined:"","hide-bottom-space":""},null,8,["modelValue","rules"]),t(E,{modelValue:o.newCase.body,"onUpdate:modelValue":e[1]||(e[1]=d=>o.newCase.body=d),placeholder:"Type your question or idea...","min-height":"5rem"},null,8,["modelValue"]),s("div",Z,[t(b,{onClick:r.submitCase,loading:o.isSaving,label:"Submit",color:"primary",class:"bg-primary text-white","no-caps":"",flat:""},{loading:l(()=>[t(U,{size:"xs"})]),_:1},8,["onClick","loading"])])]),_:1},512)]),_:1})]),_:1},8,["modelValue"])}const ee=k(X,[["render",$]]),te={data(){return{isShow:!1,caseRecord:null}},methods:{show(a){this.isShow=!0,this.caseRecord=a}}};function se(a,e,g,w,o,r){return n(),m(R,{modelValue:o.isShow,"onUpdate:modelValue":e[0]||(e[0]=d=>o.isShow=d)},{default:l(()=>[o.caseRecord?(n(),m(C,{key:0,style:{width:"100%"}},{default:l(()=>[t(h,{class:"bg-primary text-white"},{default:l(()=>[t(c,{name:"contact_support",size:"md"}),t(y,null,{default:l(()=>e[1]||(e[1]=[f("Case Details")])),_:1})]),_:1}),t(V,{class:"q-ma-md"},{default:l(()=>[t(p,{dense:"","model-value":o.caseRecord.CaseNumber,label:"Case Number",class:"q-mb-md",disable:""},null,8,["model-value"]),t(p,{dense:"","model-value":o.caseRecord.Status,label:"Status",class:"q-mb-md",disable:""},null,8,["model-value"]),t(p,{dense:"","model-value":o.caseRecord.Subject,label:"Subject",class:"q-mb-md",disable:""},null,8,["model-value"]),t(E,{dense:"",disable:"","model-value":o.caseRecord.easymeta__CaseDetail__c,"min-height":"5rem"},null,8,["model-value"])]),_:1})]),_:1})):Q("",!0)]),_:1},8,["modelValue"])}const ae=k(te,[["render",se]]),le={components:{NewCasePopup:ee,CaseDetailPopup:ae},data(){return{myCases:[],isAccountUpdating:!1,isCasesLoading:!1,nameRules:[a=>a&&a.length>0||"Required"]}},computed:{...H(v,["loginToken","customer","subscriptions","hasActiveSubscription"])},methods:{...G(v,["refreshCustomer","getCustomerCases"]),formatDatetime:K,viewCaseDetail(a){this.$refs.caseDetailCmp.show(a)},async updateAccount(){if(await this.$refs.formCmp.validate()){this.isAccountUpdating=!0;let e=await v().updateCustomerName({firstname:this.customer.easymeta__FirstName__c,lastname:this.customer.easymeta__LastName__c});e.isSuccess?J("Updated successfully."):j(e.message),this.isAccountUpdating=!1}},async loadCustomerCases(){this.isCasesLoading=!0,this.myCases=(await this.getCustomerCases())?.cases||[],this.isCasesLoading=!1}},async mounted(){this.loginToken&&await this.loadCustomerCases(),this.$nextTick(()=>{this.$route.query?.action=="newcase"&&this.$refs.newCasePopupCmp.show()})}},oe={class:"row q-mt-lg"},ie={class:"col-10 row"},ne={class:"col-6 q-pa-sm"},re={class:"col-6 q-pa-sm"},ue={class:"text-left"},de=["onClick"],me={class:"text-left"},ce={class:"text-left"},pe={class:"text-left"},_e={class:"col-12 q-pt-md"},fe={class:"text-left"},be={class:"text-left"},Ce={class:"text-left"},he={class:"text-left"},ye={class:"text-left"},ge={class:"text-left"},we={class:"text-left"};function Se(a,e,g,w,o,r){const d=D("new-case-popup"),z=D("case-detail-popup");return n(),_(q,null,[s("div",oe,[e[11]||(e[11]=s("div",{class:"col-1"},null,-1)),s("div",ie,[s("div",ne,[t(C,null,{default:l(()=>[t(h,{class:"bg-primary text-white"},{default:l(()=>[t(c,{name:"account_circle",color:"white",size:"md"}),t(y,null,{default:l(()=>e[4]||(e[4]=[f("Account Information")])),_:1}),t(b,{onClick:r.updateAccount,loading:o.isAccountUpdating,icon:"cloud_upload",class:"bg-white text-primary",dense:"","no-caps":""},null,8,["onClick","loading"])]),_:1}),t(S,null,{default:l(()=>[t(V,{ref:"formCmp"},{default:l(()=>[t(p,{modelValue:a.customer.easymeta__Email__c,"onUpdate:modelValue":e[0]||(e[0]=i=>a.customer.easymeta__Email__c=i),label:"Email address",type:"email",class:"q-mb-md",disable:"",outlined:"","hide-bottom-space":""},{prepend:l(()=>[t(c,{name:"email"})]),_:1},8,["modelValue"]),t(p,{modelValue:a.customer.easymeta__FirstName__c,"onUpdate:modelValue":e[1]||(e[1]=i=>a.customer.easymeta__FirstName__c=i),label:"First Name",class:"q-mb-md",rules:o.nameRules,"lazy-rules":"ondemand",outlined:"","hide-bottom-space":""},{prepend:l(()=>[t(c,{name:"person"})]),_:1},8,["modelValue","rules"]),t(p,{modelValue:a.customer.easymeta__LastName__c,"onUpdate:modelValue":e[2]||(e[2]=i=>a.customer.easymeta__LastName__c=i),label:"Last Name",class:"q-mb-md",rules:o.nameRules,"lazy-rules":"ondemand",outlined:"","hide-bottom-space":""},{prepend:l(()=>[t(c,{name:"person"})]),_:1},8,["modelValue","rules"])]),_:1},512)]),_:1})]),_:1})]),s("div",re,[t(C,null,{default:l(()=>[t(h,{class:"bg-primary text-white"},{default:l(()=>[t(c,{name:"contact_support",color:"white",size:"md"}),t(y,null,{default:l(()=>e[5]||(e[5]=[f("My Cases")])),_:1}),t(b,{onClick:e[3]||(e[3]=i=>a.$refs.newCasePopupCmp.show()),icon:"add_circle_outline",class:"bg-white text-primary",dense:"","no-caps":""})]),_:1}),o.isCasesLoading?(n(),m(S,{key:0,class:"text-center"},{default:l(()=>[t(U,{size:"sm",color:"primary"})]),_:1})):(n(),_(q,{key:1},[o.myCases.length?(n(),m(B,{key:0},{default:l(()=>[e[6]||(e[6]=s("thead",null,[s("tr",null,[s("th",{class:"text-left"},"Case #"),s("th",{class:"text-left"},"Subject"),s("th",{class:"text-left"},"Status"),s("th",{class:"text-left"},"CreatedDate")])],-1)),s("tbody",null,[(n(!0),_(q,null,A(o.myCases,(i,x)=>(n(),_("tr",{key:x},[s("td",ue,[s("a",{onClick:qe=>r.viewCaseDetail(i),class:"text-underline"},u(i.CaseNumber),9,de)]),s("td",me,u(i.Subject),1),s("td",ce,u(i.Status),1),s("td",pe,u(r.formatDatetime(i.CreatedDate)),1)]))),128))])]),_:1})):(n(),m(S,{key:1,class:"text-center q-py-xl"},{default:l(()=>e[7]||(e[7]=[f(" You haven't raised any cases yet! ")])),_:1}))],64))]),_:1})]),s("div",_e,[t(C,null,{default:l(()=>[t(h,{class:"bg-primary text-white"},{default:l(()=>[t(c,{name:"redeem",color:"white",size:"md"}),t(y,null,{default:l(()=>e[8]||(e[8]=[f("My Subscriptions")])),_:1}),a.hasActiveSubscription?(n(),m(b,{key:0,icon:"shopping_cart",href:"https://customer-portal.paddle.com/cpl_01jtyvfqptck70qbppg3gmhsjw",target:"_blank",label:"Manage Subscription",class:"bg-white text-primary",dense:"","no-caps":""})):Q("",!0)]),_:1}),a.subscriptions.length?(n(),m(B,{key:0},{default:l(()=>[e[9]||(e[9]=s("thead",null,[s("tr",null,[s("th",{class:"text-left"},"Name"),s("th",{class:"text-left"},"Status"),s("th",{class:"text-left"},"Started At"),s("th",{class:"text-left"},"Current Billing Starts At"),s("th",{class:"text-left"},"Current Billing Ends At"),s("th",{class:"text-left"},"Next Billed At"),s("th",{class:"text-left"},"Billing Cycle")])],-1)),s("tbody",null,[(n(!0),_(q,null,A(a.subscriptions,(i,x)=>(n(),_("tr",{key:x},[s("td",fe,u(i.Name),1),s("td",be,u(i.easymeta__Status__c),1),s("td",Ce,u(r.formatDatetime(i.easymeta__Started_At__c)),1),s("td",he,u(r.formatDatetime(i.easymeta__Current_Billing_Starts_At__c)),1),s("td",ye,u(r.formatDatetime(i.easymeta__Current_Billing_Ends_At__c)),1),s("td",ge,u(r.formatDatetime(i.easymeta__Next_Billed_At__c)),1),s("td",we,u(i.easymeta__Billing_Cycle__c),1)]))),128))])]),_:1})):(n(),m(S,{key:1,class:"text-center q-py-xl"},{default:l(()=>[e[10]||(e[10]=s("div",{class:"q-mb-md"},"You haven't subscribed Metaforce yet!",-1)),t(b,{label:"Subscribe Now","icon-right":"arrow_circle_right",class:"text-primary",to:"/pricing","no-caps":""})]),_:1}))]),_:1})])]),e[12]||(e[12]=s("div",{class:"col-1"},null,-1))]),t(d,{ref:"newCasePopupCmp",customer:a.customer,onOnSubmitted:r.loadCustomerCases},null,8,["customer","onOnSubmitted"]),t(z,{ref:"caseDetailCmp"},null,512)],64)}const Ae=k(le,[["render",Se]]);export{Ae as default};
