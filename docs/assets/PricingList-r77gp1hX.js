import{Q as C,a as Q}from"./QItemLabel-BtwGlts2.js";import{Q as T,b as P,c as le,g as Ee,d as Oe}from"./constants-BjUERERX.js";import{c as Le,av as Se,aa as Ce,ab as Ie,g as ke,ax as xe,a as se,b as q,Y as Ae,Z as De,_ as Te,H as z,D as I,G as k,C as ce,I as je,F as f,E as h,O as x,K as W,ag as Re,ai as ue,aV as Ve,J as X,N as J,aW as Ue}from"./index-YLQE3zk4.js";import{p as $,s as Ne}from"./utils-DTsUvbjS.js";import"./index-xsH4HHeE.js";const qe=Le({name:"QInnerLoading",props:{...Ce,...Se,showing:Boolean,color:String,size:{type:[String,Number],default:"42px"},label:String,labelClass:String,labelStyle:[String,Array,Object]},setup(e,{slots:r}){const a=ke(),o=Ie(e,a.proxy.$q),{transitionProps:s,transitionStyle:u}=xe(e),p=se(()=>"q-inner-loading q--avoid-card-border absolute-full column flex-center"+(o.value===!0?" q-inner-loading--dark":"")),m=se(()=>"q-inner-loading__label"+(e.labelClass!==void 0?` ${e.labelClass}`:""));function g(){const A=[q(De,{size:e.size,color:e.color})];return e.label!==void 0&&A.push(q("div",{class:m.value,style:e.labelStyle},[e.label])),A}function v(){return e.showing===!0?q("div",{class:p.value,style:u.value},r.default!==void 0?r.default():g()):null}return()=>q(Ae,s.value,v)}});function de(e,r,a,o,s,u,p){try{var m=e[u](p),g=m.value}catch(v){return void a(v)}m.done?r(g):Promise.resolve(g).then(o,s)}function ze(e){return function(){var r=this,a=arguments;return new Promise(function(o,s){var u=e.apply(r,a);function p(g){de(u,o,s,p,m,"next",g)}function m(g){de(u,o,s,p,m,"throw",g)}p(void 0)})}}function Be(e,r,a){return(r=Ye(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function fe(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),a.push.apply(a,o)}return a}function ee(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?fe(Object(a),!0).forEach(function(o){Be(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):fe(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function ve(e,r){if(e==null)return{};var a,o,s=He(e,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)a=u[o],r.includes(a)||{}.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}function He(e,r){if(e==null)return{};var a={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(r.includes(o))continue;a[o]=e[o]}return a}function te(){te=function(){return r};var e,r={},a=Object.prototype,o=a.hasOwnProperty,s=Object.defineProperty||function(n,t,i){n[t]=i.value},u=typeof Symbol=="function"?Symbol:{},p=u.iterator||"@@iterator",m=u.asyncIterator||"@@asyncIterator",g=u.toStringTag||"@@toStringTag";function v(n,t,i){return Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),n[t]}try{v({},"")}catch{v=function(t,i,c){return t[i]=c}}function A(n,t,i,c){var l=t&&t.prototype instanceof H?t:H,d=Object.create(l.prototype),y=new G(c||[]);return s(d,"_invoke",{value:we(n,i,y)}),d}function B(n,t,i){try{return{type:"normal",arg:n.call(t,i)}}catch(c){return{type:"throw",arg:c}}}r.wrap=A;var ne="suspendedStart",_e="suspendedYield",ie="executing",R="completed",w={};function H(){}function V(){}function E(){}var K={};v(K,p,function(){return this});var Y=Object.getPrototypeOf,U=Y&&Y(Y(M([])));U&&U!==a&&o.call(U,p)&&(K=U);var L=E.prototype=H.prototype=Object.create(K);function ae(n){["next","throw","return"].forEach(function(t){v(n,t,function(i){return this._invoke(t,i)})})}function N(n,t){function i(l,d,y,b){var _=B(n[l],n,d);if(_.type!=="throw"){var S=_.arg,D=S.value;return D&&typeof D=="object"&&o.call(D,"__await")?t.resolve(D.__await).then(function(O){i("next",O,y,b)},function(O){i("throw",O,y,b)}):t.resolve(D).then(function(O){S.value=O,y(S)},function(O){return i("throw",O,y,b)})}b(_.arg)}var c;s(this,"_invoke",{value:function(l,d){function y(){return new t(function(b,_){i(l,d,b,_)})}return c=c?c.then(y,y):y()}})}function we(n,t,i){var c=ne;return function(l,d){if(c===ie)throw Error("Generator is already running");if(c===R){if(l==="throw")throw d;return{value:e,done:!0}}for(i.method=l,i.arg=d;;){var y=i.delegate;if(y){var b=oe(y,i);if(b){if(b===w)continue;return b}}if(i.method==="next")i.sent=i._sent=i.arg;else if(i.method==="throw"){if(c===ne)throw c=R,i.arg;i.dispatchException(i.arg)}else i.method==="return"&&i.abrupt("return",i.arg);c=ie;var _=B(n,t,i);if(_.type==="normal"){if(c=i.done?R:_e,_.arg===w)continue;return{value:_.arg,done:i.done}}_.type==="throw"&&(c=R,i.method="throw",i.arg=_.arg)}}}function oe(n,t){var i=t.method,c=n.iterator[i];if(c===e)return t.delegate=null,i==="throw"&&n.iterator.return&&(t.method="return",t.arg=e,oe(n,t),t.method==="throw")||i!=="return"&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+i+"' method")),w;var l=B(c,n.iterator,t.arg);if(l.type==="throw")return t.method="throw",t.arg=l.arg,t.delegate=null,w;var d=l.arg;return d?d.done?(t[n.resultName]=d.value,t.next=n.nextLoc,t.method!=="return"&&(t.method="next",t.arg=e),t.delegate=null,w):d:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,w)}function Pe(n){var t={tryLoc:n[0]};1 in n&&(t.catchLoc=n[1]),2 in n&&(t.finallyLoc=n[2],t.afterLoc=n[3]),this.tryEntries.push(t)}function F(n){var t=n.completion||{};t.type="normal",delete t.arg,n.completion=t}function G(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(Pe,this),this.reset(!0)}function M(n){if(n||n===""){var t=n[p];if(t)return t.call(n);if(typeof n.next=="function")return n;if(!isNaN(n.length)){var i=-1,c=function l(){for(;++i<n.length;)if(o.call(n,i))return l.value=n[i],l.done=!1,l;return l.value=e,l.done=!0,l};return c.next=c}}throw new TypeError(typeof n+" is not iterable")}return V.prototype=E,s(L,"constructor",{value:E,configurable:!0}),s(E,"constructor",{value:V,configurable:!0}),V.displayName=v(E,g,"GeneratorFunction"),r.isGeneratorFunction=function(n){var t=typeof n=="function"&&n.constructor;return!!t&&(t===V||(t.displayName||t.name)==="GeneratorFunction")},r.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,E):(n.__proto__=E,v(n,g,"GeneratorFunction")),n.prototype=Object.create(L),n},r.awrap=function(n){return{__await:n}},ae(N.prototype),v(N.prototype,m,function(){return this}),r.AsyncIterator=N,r.async=function(n,t,i,c,l){l===void 0&&(l=Promise);var d=new N(A(n,t,i,c),l);return r.isGeneratorFunction(t)?d:d.next().then(function(y){return y.done?y.value:d.next()})},ae(L),v(L,g,"Generator"),v(L,p,function(){return this}),v(L,"toString",function(){return"[object Generator]"}),r.keys=function(n){var t=Object(n),i=[];for(var c in t)i.push(c);return i.reverse(),function l(){for(;i.length;){var d=i.pop();if(d in t)return l.value=d,l.done=!1,l}return l.done=!0,l}},r.values=M,G.prototype={constructor:G,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(F),!n)for(var t in this)t.charAt(0)==="t"&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=e)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if(n.type==="throw")throw n.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var t=this;function i(_,S){return d.type="throw",d.arg=n,t.next=_,S&&(t.method="next",t.arg=e),!!S}for(var c=this.tryEntries.length-1;c>=0;--c){var l=this.tryEntries[c],d=l.completion;if(l.tryLoc==="root")return i("end");if(l.tryLoc<=this.prev){var y=o.call(l,"catchLoc"),b=o.call(l,"finallyLoc");if(y&&b){if(this.prev<l.catchLoc)return i(l.catchLoc,!0);if(this.prev<l.finallyLoc)return i(l.finallyLoc)}else if(y){if(this.prev<l.catchLoc)return i(l.catchLoc,!0)}else{if(!b)throw Error("try statement without catch or finally");if(this.prev<l.finallyLoc)return i(l.finallyLoc)}}}},abrupt:function(n,t){for(var i=this.tryEntries.length-1;i>=0;--i){var c=this.tryEntries[i];if(c.tryLoc<=this.prev&&o.call(c,"finallyLoc")&&this.prev<c.finallyLoc){var l=c;break}}l&&(n==="break"||n==="continue")&&l.tryLoc<=t&&t<=l.finallyLoc&&(l=null);var d=l?l.completion:{};return d.type=n,d.arg=t,l?(this.method="next",this.next=l.finallyLoc,w):this.complete(d)},complete:function(n,t){if(n.type==="throw")throw n.arg;return n.type==="break"||n.type==="continue"?this.next=n.arg:n.type==="return"?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):n.type==="normal"&&t&&(this.next=t),w},finish:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===n)return this.complete(i.completion,i.afterLoc),F(i),w}},catch:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===n){var c=i.completion;if(c.type==="throw"){var l=c.arg;F(i)}return l}}throw Error("illegal catch attempt")},delegateYield:function(n,t,i){return this.delegate={iterator:M(n),resultName:t,nextLoc:i},this.method==="next"&&(this.arg=e),w}},r}function Ke(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,r);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Ye(e){var r=Ke(e,"string");return typeof r=="symbol"?r:r+""}var j={CLASSIC:"classic",V1:"v1"},Fe=j.V1,Ge="https://cdn.paddle.com/paddle/paddle.js",Me="https://cdn.paddle.com/paddle/v2/paddle.js",Qe={url:Ge},We={url:Me};function Xe(e){return document.querySelector('script[src="'.concat(e,'"]'))||void 0}function Je(e){var r=document.createElement("script");r.src=e;var a=document.head||document.body;if(!a)throw new Error("Cannot inject Paddle.js. It needs a <head> or <body> element.");return a.appendChild(r),r}var Z={classic:void 0,v1:void 0},$e={classic:"PaddleClassic",v1:"PaddleBillingV1"};function Ze(e){var r,a=(r=et(e))===null||r===void 0?void 0:r.url;if(a){var o=Z[e],s=$e[e];return o!==void 0?o:(Z[e]=new Promise(function(u,p){if(typeof window>"u"){u(void 0);return}if(window[s]){u(window[s]);return}try{var m=Xe(a);m||(m=Je(a)),m.addEventListener("load",function(){window[s]?u(window[s]):p(new Error("Paddle.js not available"))}),m.addEventListener("error",function(){p(new Error("Failed to load Paddle.js - ".concat(e)))})}catch(g){p(g);return}}),Z[e])}}function et(e){if(e===j.CLASSIC)return Qe;if(e===j.V1)return We;console.error("[Paddle] Unknown Paddle Version")}var tt=["environment","version"],rt=["environment","version"];function nt(e,r){var a=e.environment;e.version;var o=ve(e,tt);try{a&&r.Environment.set(a),r.Initialized?r.Update(ee({},o)):r.Initialize(ee({},o))}catch(s){console.warn("[Paddle] Paddle Initialization failed. Please check the inputs",s)}}function it(e,r){var a=e.environment;e.version;var o=ve(e,rt);try{a&&r.Environment.set(a),r.Setup(ee({},o))}catch(s){console.warn("[Paddle] Paddle Initialization failed. Please check the inputs",s)}}var pe;(function(e){e.CHECKOUT_LOADED="checkout.loaded",e.CHECKOUT_CLOSED="checkout.closed",e.CHECKOUT_UPDATED="checkout.updated",e.CHECKOUT_COMPLETED="checkout.completed",e.CHECKOUT_ERROR="checkout.error",e.CHECKOUT_FAILED="checkout.failed",e.CHECKOUT_ITEMS_UPDATED="checkout.items.updated",e.CHECKOUT_ITEMS_REMOVED="checkout.items.removed",e.CHECKOUT_CUSTOMER_CREATED="checkout.customer.created",e.CHECKOUT_CUSTOMER_UPDATED="checkout.customer.updated",e.CHECKOUT_CUSTOMER_REMOVED="checkout.customer.removed",e.CHECKOUT_PAYMENT_SELECTED="checkout.payment.selected",e.CHECKOUT_PAYMENT_INITIATED="checkout.payment.initiated",e.CHECKOUT_PAYMENT_FAILED="checkout.payment.failed",e.CHECKOUT_DISCOUNT_APPLIED="checkout.discount.applied",e.CHECKOUT_DISCOUNT_REMOVED="checkout.discount.removed"})(pe||(pe={}));var he;(function(e){e.DAY="day",e.WEEK="week",e.MONTH="month",e.YEAR="year"})(he||(he={}));var ye;(function(e){e.ALIPAY="alipay",e.APPLE_PAY="apple-pay",e.CARD="card",e.GOOGLE_PAY="google-pay",e.IDEAL="ideal",e.PAYPAL="paypal",e.WIRE_TRANSFER="wire-transfer",e.NONE="none"})(ye||(ye={}));var me;(function(e){e.AMERICAN_EXPRESS="american_express",e.DINERS_CLUB="diners_club",e.DISCOVER="discover",e.JCB="jcb",e.MADA="mada",e.MAESTRO="maestro",e.MASTER_CARD="mastercard",e.UNION_PAY="union_pay",e.VISA="visa",e.UNKNOWN="unknown"})(me||(me={}));var ge;(function(e){e.DRAFT="draft",e.READY="ready",e.COMPLETED="completed",e.BILLED="billed",e.canceled="canceled",e.PAST_DUE="past_due"})(ge||(ge={}));function at(e){return re.apply(this,arguments)}function re(){return re=ze(te().mark(function e(r){var a,o;return te().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return a=r?.version||Fe,u.next=3,Ze(a);case 3:if(o=u.sent,!o){u.next=9;break}return r&&(a===j.V1?nt(r,o):a===j.CLASSIC&&it(r,o)),u.abrupt("return",o);case 9:return console.error("[Paddle] Error Loading Paddle"),u.abrupt("return");case 11:case"end":return u.stop()}},e)})),re.apply(this,arguments)}const ot="test_ca588667e6359ffbb474343f37c",be="pri_01jta1x1vj0r3q7ft9byvyam2t",lt="pri_01jta21d8bn3h7m6v98nary7pf",st="pri_01jta252eyxyggvjnpehsbytgf",ct="pri_01jta26588t1nab896hrezmrtn",ut="pri_01jta2a2c2b9cadz106hr096cw",dt={items:[{quantity:1,priceId:be},{quantity:1,priceId:lt},{quantity:1,priceId:st},{quantity:1,priceId:ct},{quantity:1,priceId:ut}],address:{countryCode:"US"}},ft={emits:["onCheckoutVerified"],data(){return{paddle:null,selectedPriceId:be,paddlePrices:[],isPricesLoading:!1,isCheckoutLoading:!1,isCheckoutLoaded:!1,isCheckoutCompleted:!1,isVerifyingSubs:!1,counterOfVerify:0}},props:{token:{type:String}},computed:{isPaddleInitialized(){return this.paddle?.Initialized}},methods:{paddleEventCallback(e){e.name=="checkout.loaded"?(this.isCheckoutLoading=!1,this.isCheckoutLoaded=!0):e.name=="checkout.completed"?(this.isCheckoutCompleted=!0,this.isVerifyingSubs=!0,this.verifySubscription()):e.name=="checkout.warning"||e.name=="checkout.error"},async initializePaddle(){try{this.isPricesLoading=!0,this.paddle=await at({environment:"sandbox",token:ot,checkout:{settings:{theme:"light",frameTarget:"checkout-container",displayMode:"inline",frameInitialHeight:450,frameStyle:"background-color:white;width:100%;",variant:"one-page"}},eventCallback:this.paddleEventCallback}),this.paddle.Initialized?this.loadPaddlePrices():this.isPricesLoading=!1}catch(e){console.error("Initialization error:",e)}},async loadPaddlePrices(){const e=await Paddle.PricePreview(dt);this.paddlePrices=e.data.details.lineItems.map(r=>{let{id:a,name:o,description:s}=r.price,{discount:u,tax:p,total:m}=r.formattedTotals;return{id:a,name:o,description:s,discount:u,tax:p,total:m}}),this.isPricesLoading=!1},async verifySubscription(){let e=await await Ee(`${Oe}?token=${this.token}`);e.Id&&((e.easymeta__PaddleSubscriptions__r?.records||[]).filter(o=>["active","trialing"].includes(o.easymeta__Status__c)).length>0?(this.clearCheckout(),this.isVerifyingSubs=!1,$.setCustomer(e),this.$route.push("/customer")):this.counterOfVerify>=10?(this.clearCheckout(),this.isVerifyingSubs=!1):(await Ne(1e3),this.counterOfVerify++,await this.verifySubscription()))},async subscribeNow(){let e=$.getCustomer()?.easymeta__Email__c,r={items:[{priceId:this.selectedPriceId,quantity:1}]};if(e&&(r.customer={email:e}),this.isPaddleInitialized)try{this.isCheckoutLoading=!0,this.paddle.Checkout.open(r)}catch(a){console.error(`Checkout error: ${a.message}`)}},clearCheckout(){document.querySelector("div.checkout-container").innerHTML="",this.isCheckoutLoaded=!1}},async mounted(){let e=this.$route.query.token;e?.length>30&&(this.loginToken=e,$.setLoginToken(e)),this.paddle||this.initializePaddle()}},pt={class:"q-py-lg text-center bg-primary text-white"},ht={key:0,class:"text-center q-my-xl"};function yt(e,r,a,o,s,u){return I(),z(W,null,[k("div",pt,[f(C,{class:"text-h4"},{default:h(()=>r[2]||(r[2]=[x("Metaforce Subscriptions")])),_:1})]),s.isCheckoutLoaded?je("",!0):(I(),ce(Q,{key:0,class:"q-mx-xl q-mt-md"},{default:h(()=>[f(T,{class:"q-pl-sm"},{default:h(()=>[f(P,{class:"text-body1",style:{"font-size":"25px"}},{default:h(()=>[f(C,null,{default:h(()=>r[3]||(r[3]=[x("Choose a subscription plan")])),_:1}),f(C,{caption:""},{default:h(()=>r[4]||(r[4]=[x("During the free trial or the subscription, you can cancel the subscription at any time.")])),_:1})]),_:1})]),_:1}),s.isPricesLoading?(I(),z("div",ht,[f(le,{size:"md",color:"primary"}),r[5]||(r[5]=k("div",{class:"q-mt-md"},"Loading Subscription Plans ...",-1))])):(I(),z(W,{key:1},[f(Q,{bordered:"",separator:"",padding:""},{default:h(()=>[(I(!0),z(W,null,Re(s.paddlePrices,(p,m)=>(I(),ce(T,{key:m,tag:"label",class:ue(p.id==s.selectedPriceId?"text-primary text-bold":""),clickable:""},{default:h(()=>[f(P,{avatar:""},{default:h(()=>[f(Ve,{modelValue:s.selectedPriceId,"onUpdate:modelValue":r[0]||(r[0]=g=>s.selectedPriceId=g),val:p.id},null,8,["modelValue","val"])]),_:2},1024),f(P,null,{default:h(()=>[f(C,null,{default:h(()=>[x(X(p.name),1)]),_:2},1024),f(C,{class:ue(p.id==s.selectedPriceId?"text-primary":""),caption:""},{default:h(()=>[x(X(p.description),1)]),_:2},1032,["class"])]),_:2},1024),f(P,{avatar:""},{default:h(()=>[f(C,null,{default:h(()=>[x(X(p.total),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1}),f(T,{class:"q-pa-none q-my-md"},{default:h(()=>[f(P,null,{default:h(()=>[f(J,{disabled:!u.isPaddleInitialized,loading:s.isCheckoutLoading,onClick:u.subscribeNow,label:"Subscribe Now",color:"white",class:"bg-positive",style:{"min-height":"50px"},flat:"",stretch:"","no-caps":""},null,8,["disabled","loading","onClick"])]),_:1})]),_:1}),f(T,{class:"q-pa-none q-mt-md"},{default:h(()=>[f(P,null,{default:h(()=>[f(J,{label:"Back",style:{"min-height":"50px"},onClick:r[1]||(r[1]=p=>e.$router.go(-1)),flat:"",stretch:"","no-caps":""})]),_:1})]),_:1})],64))]),_:1})),k("div",{style:Ue(`display:${s.isCheckoutLoaded?"block":"none"}`)},[r[6]||(r[6]=k("div",{class:"checkout-container"},null,-1)),f(Q,{class:"q-mx-xl q-my-sm"},{default:h(()=>[f(T,{class:"q-pa-none q-mt-md"},{default:h(()=>[f(P,{class:"col-2"}),f(P,null,{default:h(()=>[f(J,{label:"Cancel",style:{"min-height":"50px"},onClick:u.clearCheckout,stretch:"","no-caps":""},null,8,["onClick"])]),_:1}),f(P,{class:"col-2"})]),_:1})]),_:1})],4),f(qe,{showing:s.isVerifyingSubs,style:{"background-color":"rgba(255,255,255,0.8)"},color:"primary",label:"Please wait..."},{default:h(()=>[k("div",null,[f(le,{color:"primary",size:"md"})]),r[7]||(r[7]=k("div",{class:"q-mt-md text-primary text-h6"}," Verifying your subscription... ",-1))]),_:1},8,["showing"])],64)}const wt=Te(ft,[["render",yt],["__scopeId","data-v-99561a17"]]);export{wt as default};
