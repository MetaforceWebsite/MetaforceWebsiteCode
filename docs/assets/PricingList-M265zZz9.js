import{Q as C,a as ce}from"./QItemLabel-fAT0clFs.js";import{c as ge,aa as be,g as _e,ab as we,a as z,b as E,f as W,av as Le,ax as Ce,Y as Ae,Z as xe,_ as De,R as Te,S as je,H as k,D as A,G as I,I as ke,F as p,E as h,O as x,N as $,M as Re,K as J,ag as Ue,C as Ve,ai as ue,aV as Ne,J as Z,B as de}from"./index-Lh3knRzI.js";import{Q as B,b as D,c as ee,g as qe,d as Be}from"./constants-ppmq-FrD.js";import{s as ze}from"./utils-boaHqEsX.js";import"./index-xsH4HHeE.js";const Ke=ge({name:"QBanner",props:{...be,inlineActions:Boolean,dense:Boolean,rounded:Boolean},setup(e,{slots:t}){const{proxy:{$q:a}}=_e(),o=we(e,a),s=z(()=>"q-banner row items-center"+(e.dense===!0?" q-banner--dense":"")+(o.value===!0?" q-banner--dark q-dark":"")+(e.rounded===!0?" rounded-borders":"")),u=z(()=>`q-banner__actions row items-center justify-end col-${e.inlineActions===!0?"auto":"all"}`);return()=>{const d=[E("div",{class:"q-banner__avatar col-auto row items-center self-start"},W(t.avatar)),E("div",{class:"q-banner__content col text-body2"},W(t.default))],y=W(t.action);return y!==void 0&&d.push(E("div",{class:u.value},y)),E("div",{class:s.value+(e.inlineActions===!1&&y!==void 0?" q-banner--top-padding":""),role:"alert"},d)}}}),He=ge({name:"QInnerLoading",props:{...be,...Le,showing:Boolean,color:String,size:{type:[String,Number],default:"42px"},label:String,labelClass:String,labelStyle:[String,Array,Object]},setup(e,{slots:t}){const a=_e(),o=we(e,a.proxy.$q),{transitionProps:s,transitionStyle:u}=Ce(e),d=z(()=>"q-inner-loading q--avoid-card-border absolute-full column flex-center"+(o.value===!0?" q-inner-loading--dark":"")),y=z(()=>"q-inner-loading__label"+(e.labelClass!==void 0?` ${e.labelClass}`:""));function v(){const T=[E(xe,{size:e.size,color:e.color})];return e.label!==void 0&&T.push(E("div",{class:y.value,style:e.labelStyle},[e.label])),T}function g(){return e.showing===!0?E("div",{class:d.value,style:u.value},t.default!==void 0?t.default():v()):null}return()=>E(Ae,s.value,g)}});function fe(e,t,a,o,s,u,d){try{var y=e[u](d),v=y.value}catch(g){return void a(g)}y.done?t(v):Promise.resolve(v).then(o,s)}function Ye(e){return function(){var t=this,a=arguments;return new Promise(function(o,s){var u=e.apply(t,a);function d(v){fe(u,o,s,d,y,"next",v)}function y(v){fe(u,o,s,d,y,"throw",v)}d(void 0)})}}function Fe(e,t,a){return(t=Ge(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function pe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),a.push.apply(a,o)}return a}function re(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?pe(Object(a),!0).forEach(function(o){Fe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):pe(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Ee(e,t){if(e==null)return{};var a,o,s=Me(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)a=u[o],t.includes(a)||{}.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}function Me(e,t){if(e==null)return{};var a={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.includes(o))continue;a[o]=e[o]}return a}function ne(){ne=function(){return t};var e,t={},a=Object.prototype,o=a.hasOwnProperty,s=Object.defineProperty||function(n,r,i){n[r]=i.value},u=typeof Symbol=="function"?Symbol:{},d=u.iterator||"@@iterator",y=u.asyncIterator||"@@asyncIterator",v=u.toStringTag||"@@toStringTag";function g(n,r,i){return Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}),n[r]}try{g({},"")}catch{g=function(r,i,c){return r[i]=c}}function T(n,r,i,c){var l=r&&r.prototype instanceof Y?r:Y,f=Object.create(l.prototype),m=new G(c||[]);return s(f,"_invoke",{value:Ie(n,i,m)}),f}function H(n,r,i){try{return{type:"normal",arg:n.call(r,i)}}catch(c){return{type:"throw",arg:c}}}t.wrap=T;var ae="suspendedStart",Oe="suspendedYield",oe="executing",U="completed",w={};function Y(){}function V(){}function P(){}var F={};g(F,d,function(){return this});var M=Object.getPrototypeOf,N=M&&M(M(X([])));N&&N!==a&&o.call(N,d)&&(F=N);var S=P.prototype=Y.prototype=Object.create(F);function le(n){["next","throw","return"].forEach(function(r){g(n,r,function(i){return this._invoke(r,i)})})}function q(n,r){function i(l,f,m,b){var _=H(n[l],n,f);if(_.type!=="throw"){var L=_.arg,j=L.value;return j&&typeof j=="object"&&o.call(j,"__await")?r.resolve(j.__await).then(function(O){i("next",O,m,b)},function(O){i("throw",O,m,b)}):r.resolve(j).then(function(O){L.value=O,m(L)},function(O){return i("throw",O,m,b)})}b(_.arg)}var c;s(this,"_invoke",{value:function(l,f){function m(){return new r(function(b,_){i(l,f,b,_)})}return c=c?c.then(m,m):m()}})}function Ie(n,r,i){var c=ae;return function(l,f){if(c===oe)throw Error("Generator is already running");if(c===U){if(l==="throw")throw f;return{value:e,done:!0}}for(i.method=l,i.arg=f;;){var m=i.delegate;if(m){var b=se(m,i);if(b){if(b===w)continue;return b}}if(i.method==="next")i.sent=i._sent=i.arg;else if(i.method==="throw"){if(c===ae)throw c=U,i.arg;i.dispatchException(i.arg)}else i.method==="return"&&i.abrupt("return",i.arg);c=oe;var _=H(n,r,i);if(_.type==="normal"){if(c=i.done?U:Oe,_.arg===w)continue;return{value:_.arg,done:i.done}}_.type==="throw"&&(c=U,i.method="throw",i.arg=_.arg)}}}function se(n,r){var i=r.method,c=n.iterator[i];if(c===e)return r.delegate=null,i==="throw"&&n.iterator.return&&(r.method="return",r.arg=e,se(n,r),r.method==="throw")||i!=="return"&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),w;var l=H(c,n.iterator,r.arg);if(l.type==="throw")return r.method="throw",r.arg=l.arg,r.delegate=null,w;var f=l.arg;return f?f.done?(r[n.resultName]=f.value,r.next=n.nextLoc,r.method!=="return"&&(r.method="next",r.arg=e),r.delegate=null,w):f:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,w)}function Se(n){var r={tryLoc:n[0]};1 in n&&(r.catchLoc=n[1]),2 in n&&(r.finallyLoc=n[2],r.afterLoc=n[3]),this.tryEntries.push(r)}function Q(n){var r=n.completion||{};r.type="normal",delete r.arg,n.completion=r}function G(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(Se,this),this.reset(!0)}function X(n){if(n||n===""){var r=n[d];if(r)return r.call(n);if(typeof n.next=="function")return n;if(!isNaN(n.length)){var i=-1,c=function l(){for(;++i<n.length;)if(o.call(n,i))return l.value=n[i],l.done=!1,l;return l.value=e,l.done=!0,l};return c.next=c}}throw new TypeError(typeof n+" is not iterable")}return V.prototype=P,s(S,"constructor",{value:P,configurable:!0}),s(P,"constructor",{value:V,configurable:!0}),V.displayName=g(P,v,"GeneratorFunction"),t.isGeneratorFunction=function(n){var r=typeof n=="function"&&n.constructor;return!!r&&(r===V||(r.displayName||r.name)==="GeneratorFunction")},t.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,P):(n.__proto__=P,g(n,v,"GeneratorFunction")),n.prototype=Object.create(S),n},t.awrap=function(n){return{__await:n}},le(q.prototype),g(q.prototype,y,function(){return this}),t.AsyncIterator=q,t.async=function(n,r,i,c,l){l===void 0&&(l=Promise);var f=new q(T(n,r,i,c),l);return t.isGeneratorFunction(r)?f:f.next().then(function(m){return m.done?m.value:f.next()})},le(S),g(S,v,"Generator"),g(S,d,function(){return this}),g(S,"toString",function(){return"[object Generator]"}),t.keys=function(n){var r=Object(n),i=[];for(var c in r)i.push(c);return i.reverse(),function l(){for(;i.length;){var f=i.pop();if(f in r)return l.value=f,l.done=!1,l}return l.done=!0,l}},t.values=X,G.prototype={constructor:G,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(Q),!n)for(var r in this)r.charAt(0)==="t"&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if(n.type==="throw")throw n.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function i(_,L){return f.type="throw",f.arg=n,r.next=_,L&&(r.method="next",r.arg=e),!!L}for(var c=this.tryEntries.length-1;c>=0;--c){var l=this.tryEntries[c],f=l.completion;if(l.tryLoc==="root")return i("end");if(l.tryLoc<=this.prev){var m=o.call(l,"catchLoc"),b=o.call(l,"finallyLoc");if(m&&b){if(this.prev<l.catchLoc)return i(l.catchLoc,!0);if(this.prev<l.finallyLoc)return i(l.finallyLoc)}else if(m){if(this.prev<l.catchLoc)return i(l.catchLoc,!0)}else{if(!b)throw Error("try statement without catch or finally");if(this.prev<l.finallyLoc)return i(l.finallyLoc)}}}},abrupt:function(n,r){for(var i=this.tryEntries.length-1;i>=0;--i){var c=this.tryEntries[i];if(c.tryLoc<=this.prev&&o.call(c,"finallyLoc")&&this.prev<c.finallyLoc){var l=c;break}}l&&(n==="break"||n==="continue")&&l.tryLoc<=r&&r<=l.finallyLoc&&(l=null);var f=l?l.completion:{};return f.type=n,f.arg=r,l?(this.method="next",this.next=l.finallyLoc,w):this.complete(f)},complete:function(n,r){if(n.type==="throw")throw n.arg;return n.type==="break"||n.type==="continue"?this.next=n.arg:n.type==="return"?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):n.type==="normal"&&r&&(this.next=r),w},finish:function(n){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.finallyLoc===n)return this.complete(i.completion,i.afterLoc),Q(i),w}},catch:function(n){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc===n){var c=i.completion;if(c.type==="throw"){var l=c.arg;Q(i)}return l}}throw Error("illegal catch attempt")},delegateYield:function(n,r,i){return this.delegate={iterator:X(n),resultName:r,nextLoc:i},this.method==="next"&&(this.arg=e),w}},t}function Qe(e,t){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ge(e){var t=Qe(e,"string");return typeof t=="symbol"?t:t+""}var R={CLASSIC:"classic",V1:"v1"},Xe=R.V1,We="https://cdn.paddle.com/paddle/paddle.js",$e="https://cdn.paddle.com/paddle/v2/paddle.js",Je={url:We},Ze={url:$e};function et(e){return document.querySelector('script[src="'.concat(e,'"]'))||void 0}function tt(e){var t=document.createElement("script");t.src=e;var a=document.head||document.body;if(!a)throw new Error("Cannot inject Paddle.js. It needs a <head> or <body> element.");return a.appendChild(t),t}var te={classic:void 0,v1:void 0},rt={classic:"PaddleClassic",v1:"PaddleBillingV1"};function nt(e){var t,a=(t=it(e))===null||t===void 0?void 0:t.url;if(a){var o=te[e],s=rt[e];return o!==void 0?o:(te[e]=new Promise(function(u,d){if(typeof window>"u"){u(void 0);return}if(window[s]){u(window[s]);return}try{var y=et(a);y||(y=tt(a)),y.addEventListener("load",function(){window[s]?u(window[s]):d(new Error("Paddle.js not available"))}),y.addEventListener("error",function(){d(new Error("Failed to load Paddle.js - ".concat(e)))})}catch(v){d(v);return}}),te[e])}}function it(e){if(e===R.CLASSIC)return Je;if(e===R.V1)return Ze;console.error("[Paddle] Unknown Paddle Version")}var at=["environment","version"],ot=["environment","version"];function lt(e,t){var a=e.environment;e.version;var o=Ee(e,at);try{a&&t.Environment.set(a),t.Initialized?t.Update(re({},o)):t.Initialize(re({},o))}catch(s){console.warn("[Paddle] Paddle Initialization failed. Please check the inputs",s)}}function st(e,t){var a=e.environment;e.version;var o=Ee(e,ot);try{a&&t.Environment.set(a),t.Setup(re({},o))}catch(s){console.warn("[Paddle] Paddle Initialization failed. Please check the inputs",s)}}var K;(function(e){e.CHECKOUT_LOADED="checkout.loaded",e.CHECKOUT_CLOSED="checkout.closed",e.CHECKOUT_UPDATED="checkout.updated",e.CHECKOUT_COMPLETED="checkout.completed",e.CHECKOUT_ERROR="checkout.error",e.CHECKOUT_FAILED="checkout.failed",e.CHECKOUT_ITEMS_UPDATED="checkout.items.updated",e.CHECKOUT_ITEMS_REMOVED="checkout.items.removed",e.CHECKOUT_CUSTOMER_CREATED="checkout.customer.created",e.CHECKOUT_CUSTOMER_UPDATED="checkout.customer.updated",e.CHECKOUT_CUSTOMER_REMOVED="checkout.customer.removed",e.CHECKOUT_PAYMENT_SELECTED="checkout.payment.selected",e.CHECKOUT_PAYMENT_INITIATED="checkout.payment.initiated",e.CHECKOUT_PAYMENT_FAILED="checkout.payment.failed",e.CHECKOUT_DISCOUNT_APPLIED="checkout.discount.applied",e.CHECKOUT_DISCOUNT_REMOVED="checkout.discount.removed"})(K||(K={}));var he;(function(e){e.DAY="day",e.WEEK="week",e.MONTH="month",e.YEAR="year"})(he||(he={}));var ye;(function(e){e.ALIPAY="alipay",e.APPLE_PAY="apple-pay",e.CARD="card",e.GOOGLE_PAY="google-pay",e.IDEAL="ideal",e.PAYPAL="paypal",e.WIRE_TRANSFER="wire-transfer",e.NONE="none"})(ye||(ye={}));var me;(function(e){e.AMERICAN_EXPRESS="american_express",e.DINERS_CLUB="diners_club",e.DISCOVER="discover",e.JCB="jcb",e.MADA="mada",e.MAESTRO="maestro",e.MASTER_CARD="mastercard",e.UNION_PAY="union_pay",e.VISA="visa",e.UNKNOWN="unknown"})(me||(me={}));var ve;(function(e){e.DRAFT="draft",e.READY="ready",e.COMPLETED="completed",e.BILLED="billed",e.canceled="canceled",e.PAST_DUE="past_due"})(ve||(ve={}));function ct(e){return ie.apply(this,arguments)}function ie(){return ie=Ye(ne().mark(function e(t){var a,o;return ne().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return a=t?.version||Xe,u.next=3,nt(a);case 3:if(o=u.sent,!o){u.next=9;break}return t&&(a===R.V1?lt(t,o):a===R.CLASSIC&&st(t,o)),u.abrupt("return",o);case 9:return console.error("[Paddle] Error Loading Paddle"),u.abrupt("return");case 11:case"end":return u.stop()}},e)})),ie.apply(this,arguments)}const ut="test_ca588667e6359ffbb474343f37c",Pe="pri_01jta1x1vj0r3q7ft9byvyam2t",dt="pri_01jta21d8bn3h7m6v98nary7pf",ft="pri_01jta252eyxyggvjnpehsbytgf",pt="pri_01jta26588t1nab896hrezmrtn",ht="pri_01jta2a2c2b9cadz106hr096cw",yt={items:[{quantity:1,priceId:Pe},{quantity:1,priceId:dt},{quantity:1,priceId:ft},{quantity:1,priceId:pt},{quantity:1,priceId:ht}]},mt={emits:["onCheckoutVerified"],data(){return{paddle:null,selectedPriceId:Pe,paddlePrices:[],isPricesLoading:!1,isCheckoutLoading:!1,isVerifyingSubs:!1,counterOfVerify:0}},computed:{...je(de,["loginToken","customer","hasActiveSubscription"]),isPaddleInitialized(){return this.paddle?.Initialized}},methods:{...Te(de,["updateCustomer"]),paddleEventCallback(e){e.name==K.CHECKOUT_LOADED?this.isCheckoutLoading=!1:e.name==K.CHECKOUT_COMPLETED&&(this.paddle.Checkout.close(),this.isVerifyingSubs=!0,this.verifySubscription())},async initializePaddle(){try{this.isPricesLoading=!0,this.paddle=await ct({environment:"sandbox",token:ut,checkout:{settings:{theme:"light",displayMode:"overlay",frameInitialHeight:450}},eventCallback:this.paddleEventCallback}),this.paddle.Initialized?this.loadPaddlePrices():this.isPricesLoading=!1}catch(e){console.error("Initialization error:",e)}},async loadPaddlePrices(){const e=await this.paddle.PricePreview(yt);this.paddlePrices=e.data.details.lineItems.map(t=>{let{id:a,name:o,description:s}=t.price,{discount:u,tax:d,total:y}=t.formattedTotals;return{id:a,name:o,description:s,discount:u,tax:d,total:y}}),this.isPricesLoading=!1},async verifySubscription(){let e=await qe(`${Be}?token=${this.loginToken}`);e.Id&&(this.updateCustomer(e),this.hasActiveSubscription||this.counterOfVerify>=5?(this.isVerifyingSubs=!1,this.$router.push("/customer")):(await ze(1e3),this.counterOfVerify++,await this.verifySubscription()))},async subscribeNow(){let e=this.customer?.easymeta__Email__c,t={items:[{priceId:this.selectedPriceId,quantity:1}]};if(e&&(t.customer={email:e}),this.isPaddleInitialized)try{this.isCheckoutLoading=!0,this.paddle.Checkout.open(t)}catch(a){console.error(`Checkout error: ${a.message}`)}}},async mounted(){let e=this.$route.query.token;e?.length>30&&this.updateLoginToken(e),this.paddle||this.initializePaddle()}},vt={class:"q-py-lg text-center bg-primary text-white"},gt={key:0,class:"row q-ma-md"},bt={key:0,class:"text-center q-my-xl"};function _t(e,t,a,o,s,u){return A(),k(J,null,[I("div",vt,[p(C,{class:"text-h4"},{default:h(()=>t[2]||(t[2]=[x("Metaforce Subscriptions")])),_:1})]),e.hasActiveSubscription?(A(),k("div",gt,[t[4]||(t[4]=I("div",{class:"col"},null,-1)),p(Ke,{"inline-actions":"",rounded:"",class:"col-5 bg-positive text-white text-center"},{avatar:h(()=>[p(Re,{name:"campaign"})]),action:h(()=>[p($,{flat:"","no-caps":"",to:"/customer",label:"View"})]),default:h(()=>[t[3]||(t[3]=I("span",null,"You have at least one active metaforce subscription already.",-1))]),_:1}),t[5]||(t[5]=I("div",{class:"col"},null,-1))])):ke("",!0),p(ce,{class:"q-mx-xl q-mt-md"},{default:h(()=>[p(B,{class:"q-pl-sm"},{default:h(()=>[p(D,{class:"text-body1",style:{"font-size":"25px"}},{default:h(()=>[p(C,null,{default:h(()=>t[6]||(t[6]=[x("Choose a subscription plan")])),_:1}),p(C,{caption:""},{default:h(()=>t[7]||(t[7]=[x("During the free trial or the subscription, you can cancel the subscription at any time.")])),_:1})]),_:1})]),_:1}),s.isPricesLoading?(A(),k("div",bt,[p(ee,{size:"md",color:"primary"}),t[8]||(t[8]=I("div",{class:"q-mt-md"},"Loading Subscription Plans ...",-1))])):(A(),k(J,{key:1},[p(ce,{bordered:"",separator:"",padding:""},{default:h(()=>[(A(!0),k(J,null,Ue(s.paddlePrices,(d,y)=>(A(),Ve(B,{key:y,tag:"label",class:ue(d.id==s.selectedPriceId?"text-primary text-bold":""),clickable:""},{default:h(()=>[p(D,{avatar:""},{default:h(()=>[p(Ne,{modelValue:s.selectedPriceId,"onUpdate:modelValue":t[0]||(t[0]=v=>s.selectedPriceId=v),val:d.id},null,8,["modelValue","val"])]),_:2},1024),p(D,null,{default:h(()=>[p(C,null,{default:h(()=>[x(Z(d.name),1)]),_:2},1024),p(C,{class:ue(d.id==s.selectedPriceId?"text-primary":""),caption:""},{default:h(()=>[x(Z(d.description),1)]),_:2},1032,["class"])]),_:2},1024),p(D,{avatar:""},{default:h(()=>[p(C,null,{default:h(()=>[x(Z(d.total),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1}),p(B,{class:"q-pa-none q-my-md"},{default:h(()=>[p(D,null,{default:h(()=>[p($,{disabled:!u.isPaddleInitialized,loading:s.isCheckoutLoading,onClick:u.subscribeNow,label:"Subscribe Now",color:"white",class:"bg-positive",style:{"min-height":"50px"},flat:"",stretch:"","no-caps":""},{loading:h(()=>[p(ee,{size:"sm"})]),_:1},8,["disabled","loading","onClick"])]),_:1})]),_:1}),p(B,{class:"q-pa-none q-mt-md"},{default:h(()=>[p(D,null,{default:h(()=>[p($,{label:"Back",style:{"min-height":"50px"},onClick:t[1]||(t[1]=d=>e.$router.go(-1)),flat:"",stretch:"","no-caps":""})]),_:1})]),_:1})],64))]),_:1}),p(He,{showing:s.isVerifyingSubs,style:{"background-color":"rgba(255,255,255,0.8)"},color:"primary",label:"Please wait..."},{default:h(()=>[I("div",null,[p(ee,{color:"primary",size:"md"})]),t[9]||(t[9]=I("div",{class:"q-mt-md text-primary text-h6"}," Verifying your subscription... ",-1))]),_:1},8,["showing"])],64)}const St=De(mt,[["render",_t],["__scopeId","data-v-d61cb412"]]);export{St as default};
