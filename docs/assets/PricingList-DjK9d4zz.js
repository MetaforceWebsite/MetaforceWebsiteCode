import{Q as L,a as oe}from"./QItemLabel-BwSpoMxU.js";import{Q as N,b as S,c as X,g as we,d as Pe}from"./constants-g34vuJZR.js";import{c as Oe,av as Ie,aa as Le,ab as Se,g as Ce,ax as Ae,a as le,b as V,Y as De,Z as xe,_ as Te,R as je,S as Re,H as q,D as x,G as z,F as p,E as h,O as C,K as W,ag as Ue,C as ke,ai as se,aV as Ne,J as $,N as ce,B as ue}from"./index-BJEd6HmL.js";import{s as Ve}from"./utils-CKXwkbnV.js";import"./index-xsH4HHeE.js";const qe=Oe({name:"QInnerLoading",props:{...Le,...Ie,showing:Boolean,color:String,size:{type:[String,Number],default:"42px"},label:String,labelClass:String,labelStyle:[String,Array,Object]},setup(e,{slots:n}){const a=Ce(),o=Se(e,a.proxy.$q),{transitionProps:c,transitionStyle:u}=Ae(e),f=le(()=>"q-inner-loading q--avoid-card-border absolute-full column flex-center"+(o.value===!0?" q-inner-loading--dark":"")),m=le(()=>"q-inner-loading__label"+(e.labelClass!==void 0?` ${e.labelClass}`:""));function g(){const A=[V(xe,{size:e.size,color:e.color})];return e.label!==void 0&&A.push(V("div",{class:m.value,style:e.labelStyle},[e.label])),A}function v(){return e.showing===!0?V("div",{class:f.value,style:u.value},n.default!==void 0?n.default():g()):null}return()=>V(De,c.value,v)}});function de(e,n,a,o,c,u,f){try{var m=e[u](f),g=m.value}catch(v){return void a(v)}m.done?n(g):Promise.resolve(g).then(o,c)}function ze(e){return function(){var n=this,a=arguments;return new Promise(function(o,c){var u=e.apply(n,a);function f(g){de(u,o,c,f,m,"next",g)}function m(g){de(u,o,c,f,m,"throw",g)}f(void 0)})}}function Be(e,n,a){return(n=Ye(n))in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function fe(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function Z(e){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?fe(Object(a),!0).forEach(function(o){Be(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):fe(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function ge(e,n){if(e==null)return{};var a,o,c=Ke(e,n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)a=u[o],n.includes(a)||{}.propertyIsEnumerable.call(e,a)&&(c[a]=e[a])}return c}function Ke(e,n){if(e==null)return{};var a={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(n.includes(o))continue;a[o]=e[o]}return a}function ee(){ee=function(){return n};var e,n={},a=Object.prototype,o=a.hasOwnProperty,c=Object.defineProperty||function(r,t,i){r[t]=i.value},u=typeof Symbol=="function"?Symbol:{},f=u.iterator||"@@iterator",m=u.asyncIterator||"@@asyncIterator",g=u.toStringTag||"@@toStringTag";function v(r,t,i){return Object.defineProperty(r,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),r[t]}try{v({},"")}catch{v=function(t,i,s){return t[i]=s}}function A(r,t,i,s){var l=t&&t.prototype instanceof H?t:H,d=Object.create(l.prototype),y=new M(s||[]);return c(d,"_invoke",{value:_e(r,i,y)}),d}function K(r,t,i){try{return{type:"normal",arg:r.call(t,i)}}catch(s){return{type:"throw",arg:s}}}n.wrap=A;var re="suspendedStart",be="suspendedYield",ne="executing",j="completed",E={};function H(){}function R(){}function w(){}var Y={};v(Y,f,function(){return this});var F=Object.getPrototypeOf,U=F&&F(F(Q([])));U&&U!==a&&o.call(U,f)&&(Y=U);var O=w.prototype=H.prototype=Object.create(Y);function ie(r){["next","throw","return"].forEach(function(t){v(r,t,function(i){return this._invoke(t,i)})})}function k(r,t){function i(l,d,y,b){var _=K(r[l],r,d);if(_.type!=="throw"){var I=_.arg,D=I.value;return D&&typeof D=="object"&&o.call(D,"__await")?t.resolve(D.__await).then(function(P){i("next",P,y,b)},function(P){i("throw",P,y,b)}):t.resolve(D).then(function(P){I.value=P,y(I)},function(P){return i("throw",P,y,b)})}b(_.arg)}var s;c(this,"_invoke",{value:function(l,d){function y(){return new t(function(b,_){i(l,d,b,_)})}return s=s?s.then(y,y):y()}})}function _e(r,t,i){var s=re;return function(l,d){if(s===ne)throw Error("Generator is already running");if(s===j){if(l==="throw")throw d;return{value:e,done:!0}}for(i.method=l,i.arg=d;;){var y=i.delegate;if(y){var b=ae(y,i);if(b){if(b===E)continue;return b}}if(i.method==="next")i.sent=i._sent=i.arg;else if(i.method==="throw"){if(s===re)throw s=j,i.arg;i.dispatchException(i.arg)}else i.method==="return"&&i.abrupt("return",i.arg);s=ne;var _=K(r,t,i);if(_.type==="normal"){if(s=i.done?j:be,_.arg===E)continue;return{value:_.arg,done:i.done}}_.type==="throw"&&(s=j,i.method="throw",i.arg=_.arg)}}}function ae(r,t){var i=t.method,s=r.iterator[i];if(s===e)return t.delegate=null,i==="throw"&&r.iterator.return&&(t.method="return",t.arg=e,ae(r,t),t.method==="throw")||i!=="return"&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+i+"' method")),E;var l=K(s,r.iterator,t.arg);if(l.type==="throw")return t.method="throw",t.arg=l.arg,t.delegate=null,E;var d=l.arg;return d?d.done?(t[r.resultName]=d.value,t.next=r.nextLoc,t.method!=="return"&&(t.method="next",t.arg=e),t.delegate=null,E):d:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,E)}function Ee(r){var t={tryLoc:r[0]};1 in r&&(t.catchLoc=r[1]),2 in r&&(t.finallyLoc=r[2],t.afterLoc=r[3]),this.tryEntries.push(t)}function G(r){var t=r.completion||{};t.type="normal",delete t.arg,r.completion=t}function M(r){this.tryEntries=[{tryLoc:"root"}],r.forEach(Ee,this),this.reset(!0)}function Q(r){if(r||r===""){var t=r[f];if(t)return t.call(r);if(typeof r.next=="function")return r;if(!isNaN(r.length)){var i=-1,s=function l(){for(;++i<r.length;)if(o.call(r,i))return l.value=r[i],l.done=!1,l;return l.value=e,l.done=!0,l};return s.next=s}}throw new TypeError(typeof r+" is not iterable")}return R.prototype=w,c(O,"constructor",{value:w,configurable:!0}),c(w,"constructor",{value:R,configurable:!0}),R.displayName=v(w,g,"GeneratorFunction"),n.isGeneratorFunction=function(r){var t=typeof r=="function"&&r.constructor;return!!t&&(t===R||(t.displayName||t.name)==="GeneratorFunction")},n.mark=function(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,w):(r.__proto__=w,v(r,g,"GeneratorFunction")),r.prototype=Object.create(O),r},n.awrap=function(r){return{__await:r}},ie(k.prototype),v(k.prototype,m,function(){return this}),n.AsyncIterator=k,n.async=function(r,t,i,s,l){l===void 0&&(l=Promise);var d=new k(A(r,t,i,s),l);return n.isGeneratorFunction(t)?d:d.next().then(function(y){return y.done?y.value:d.next()})},ie(O),v(O,g,"Generator"),v(O,f,function(){return this}),v(O,"toString",function(){return"[object Generator]"}),n.keys=function(r){var t=Object(r),i=[];for(var s in t)i.push(s);return i.reverse(),function l(){for(;i.length;){var d=i.pop();if(d in t)return l.value=d,l.done=!1,l}return l.done=!0,l}},n.values=Q,M.prototype={constructor:M,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(G),!r)for(var t in this)t.charAt(0)==="t"&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=e)},stop:function(){this.done=!0;var r=this.tryEntries[0].completion;if(r.type==="throw")throw r.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var t=this;function i(_,I){return d.type="throw",d.arg=r,t.next=_,I&&(t.method="next",t.arg=e),!!I}for(var s=this.tryEntries.length-1;s>=0;--s){var l=this.tryEntries[s],d=l.completion;if(l.tryLoc==="root")return i("end");if(l.tryLoc<=this.prev){var y=o.call(l,"catchLoc"),b=o.call(l,"finallyLoc");if(y&&b){if(this.prev<l.catchLoc)return i(l.catchLoc,!0);if(this.prev<l.finallyLoc)return i(l.finallyLoc)}else if(y){if(this.prev<l.catchLoc)return i(l.catchLoc,!0)}else{if(!b)throw Error("try statement without catch or finally");if(this.prev<l.finallyLoc)return i(l.finallyLoc)}}}},abrupt:function(r,t){for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i];if(s.tryLoc<=this.prev&&o.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var l=s;break}}l&&(r==="break"||r==="continue")&&l.tryLoc<=t&&t<=l.finallyLoc&&(l=null);var d=l?l.completion:{};return d.type=r,d.arg=t,l?(this.method="next",this.next=l.finallyLoc,E):this.complete(d)},complete:function(r,t){if(r.type==="throw")throw r.arg;return r.type==="break"||r.type==="continue"?this.next=r.arg:r.type==="return"?(this.rval=this.arg=r.arg,this.method="return",this.next="end"):r.type==="normal"&&t&&(this.next=t),E},finish:function(r){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===r)return this.complete(i.completion,i.afterLoc),G(i),E}},catch:function(r){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===r){var s=i.completion;if(s.type==="throw"){var l=s.arg;G(i)}return l}}throw Error("illegal catch attempt")},delegateYield:function(r,t,i){return this.delegate={iterator:Q(r),resultName:t,nextLoc:i},this.method==="next"&&(this.arg=e),E}},n}function He(e,n){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,n);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Ye(e){var n=He(e,"string");return typeof n=="symbol"?n:n+""}var T={CLASSIC:"classic",V1:"v1"},Fe=T.V1,Ge="https://cdn.paddle.com/paddle/paddle.js",Me="https://cdn.paddle.com/paddle/v2/paddle.js",Qe={url:Ge},Xe={url:Me};function We(e){return document.querySelector('script[src="'.concat(e,'"]'))||void 0}function $e(e){var n=document.createElement("script");n.src=e;var a=document.head||document.body;if(!a)throw new Error("Cannot inject Paddle.js. It needs a <head> or <body> element.");return a.appendChild(n),n}var J={classic:void 0,v1:void 0},Je={classic:"PaddleClassic",v1:"PaddleBillingV1"};function Ze(e){var n,a=(n=et(e))===null||n===void 0?void 0:n.url;if(a){var o=J[e],c=Je[e];return o!==void 0?o:(J[e]=new Promise(function(u,f){if(typeof window>"u"){u(void 0);return}if(window[c]){u(window[c]);return}try{var m=We(a);m||(m=$e(a)),m.addEventListener("load",function(){window[c]?u(window[c]):f(new Error("Paddle.js not available"))}),m.addEventListener("error",function(){f(new Error("Failed to load Paddle.js - ".concat(e)))})}catch(g){f(g);return}}),J[e])}}function et(e){if(e===T.CLASSIC)return Qe;if(e===T.V1)return Xe;console.error("[Paddle] Unknown Paddle Version")}var tt=["environment","version"],rt=["environment","version"];function nt(e,n){var a=e.environment;e.version;var o=ge(e,tt);try{a&&n.Environment.set(a),n.Initialized?n.Update(Z({},o)):n.Initialize(Z({},o))}catch(c){console.warn("[Paddle] Paddle Initialization failed. Please check the inputs",c)}}function it(e,n){var a=e.environment;e.version;var o=ge(e,rt);try{a&&n.Environment.set(a),n.Setup(Z({},o))}catch(c){console.warn("[Paddle] Paddle Initialization failed. Please check the inputs",c)}}var B;(function(e){e.CHECKOUT_LOADED="checkout.loaded",e.CHECKOUT_CLOSED="checkout.closed",e.CHECKOUT_UPDATED="checkout.updated",e.CHECKOUT_COMPLETED="checkout.completed",e.CHECKOUT_ERROR="checkout.error",e.CHECKOUT_FAILED="checkout.failed",e.CHECKOUT_ITEMS_UPDATED="checkout.items.updated",e.CHECKOUT_ITEMS_REMOVED="checkout.items.removed",e.CHECKOUT_CUSTOMER_CREATED="checkout.customer.created",e.CHECKOUT_CUSTOMER_UPDATED="checkout.customer.updated",e.CHECKOUT_CUSTOMER_REMOVED="checkout.customer.removed",e.CHECKOUT_PAYMENT_SELECTED="checkout.payment.selected",e.CHECKOUT_PAYMENT_INITIATED="checkout.payment.initiated",e.CHECKOUT_PAYMENT_FAILED="checkout.payment.failed",e.CHECKOUT_DISCOUNT_APPLIED="checkout.discount.applied",e.CHECKOUT_DISCOUNT_REMOVED="checkout.discount.removed"})(B||(B={}));var pe;(function(e){e.DAY="day",e.WEEK="week",e.MONTH="month",e.YEAR="year"})(pe||(pe={}));var he;(function(e){e.ALIPAY="alipay",e.APPLE_PAY="apple-pay",e.CARD="card",e.GOOGLE_PAY="google-pay",e.IDEAL="ideal",e.PAYPAL="paypal",e.WIRE_TRANSFER="wire-transfer",e.NONE="none"})(he||(he={}));var ye;(function(e){e.AMERICAN_EXPRESS="american_express",e.DINERS_CLUB="diners_club",e.DISCOVER="discover",e.JCB="jcb",e.MADA="mada",e.MAESTRO="maestro",e.MASTER_CARD="mastercard",e.UNION_PAY="union_pay",e.VISA="visa",e.UNKNOWN="unknown"})(ye||(ye={}));var me;(function(e){e.DRAFT="draft",e.READY="ready",e.COMPLETED="completed",e.BILLED="billed",e.canceled="canceled",e.PAST_DUE="past_due"})(me||(me={}));function at(e){return te.apply(this,arguments)}function te(){return te=ze(ee().mark(function e(n){var a,o;return ee().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return a=n?.version||Fe,u.next=3,Ze(a);case 3:if(o=u.sent,!o){u.next=9;break}return n&&(a===T.V1?nt(n,o):a===T.CLASSIC&&it(n,o)),u.abrupt("return",o);case 9:return console.error("[Paddle] Error Loading Paddle"),u.abrupt("return");case 11:case"end":return u.stop()}},e)})),te.apply(this,arguments)}const ot="test_ca588667e6359ffbb474343f37c",ve="pri_01jta1x1vj0r3q7ft9byvyam2t",lt="pri_01jta21d8bn3h7m6v98nary7pf",st="pri_01jta252eyxyggvjnpehsbytgf",ct="pri_01jta26588t1nab896hrezmrtn",ut="pri_01jta2a2c2b9cadz106hr096cw",dt={items:[{quantity:1,priceId:ve},{quantity:1,priceId:lt},{quantity:1,priceId:st},{quantity:1,priceId:ct},{quantity:1,priceId:ut}]},ft={emits:["onCheckoutVerified"],data(){return{paddle:null,selectedPriceId:ve,paddlePrices:[],isPricesLoading:!1,isCheckoutLoading:!1,isVerifyingSubs:!1,counterOfVerify:0}},computed:{...Re(ue,["loginToken","customer","hasActiveSubscription"]),isPaddleInitialized(){return this.paddle?.Initialized}},methods:{...je(ue,["updateCustomer"]),paddleEventCallback(e){e.name==B.CHECKOUT_LOADED?this.isCheckoutLoading=!1:e.name==B.CHECKOUT_COMPLETED&&(this.paddle.Checkout.close(),this.isVerifyingSubs=!0,this.verifySubscription())},async initializePaddle(){try{this.isPricesLoading=!0,this.paddle=await at({environment:"sandbox",token:ot,checkout:{settings:{theme:"light",displayMode:"overlay",frameInitialHeight:450}},eventCallback:this.paddleEventCallback}),this.paddle.Initialized?this.loadPaddlePrices():this.isPricesLoading=!1}catch(e){console.error("Initialization error:",e)}},async loadPaddlePrices(){const e=await this.paddle.PricePreview(dt);this.paddlePrices=e.data.details.lineItems.map(n=>{let{id:a,name:o,description:c}=n.price,{discount:u,tax:f,total:m}=n.formattedTotals;return{id:a,name:o,description:c,discount:u,tax:f,total:m}}),this.isPricesLoading=!1},async verifySubscription(){let e=await we(`${Pe}?token=${this.loginToken}`);e.Id&&(this.updateCustomer(e),this.hasActiveSubscription||this.counterOfVerify>=5?(this.isVerifyingSubs=!1,this.$router.push("/customer")):(await Ve(1e3),this.counterOfVerify++,await this.verifySubscription()))},async subscribeNow(){let e=this.customer?.easymeta__Email__c,n={items:[{priceId:this.selectedPriceId,quantity:1}]};if(e&&(n.customer={email:e}),this.isPaddleInitialized)try{this.isCheckoutLoading=!0,this.paddle.Checkout.open(n)}catch(a){console.error(`Checkout error: ${a.message}`)}}},async mounted(){let e=this.$route.query.token;e?.length>30&&this.updateLoginToken(e),this.paddle||this.initializePaddle()}},pt={class:"q-py-lg text-center bg-primary text-white"},ht={key:0,class:"text-center q-my-xl"};function yt(e,n,a,o,c,u){return x(),q(W,null,[z("div",pt,[p(L,{class:"text-h4"},{default:h(()=>n[2]||(n[2]=[C("Metaforce Subscriptions")])),_:1})]),p(oe,{class:"q-mx-xl q-mt-md"},{default:h(()=>[p(N,{class:"q-pl-sm"},{default:h(()=>[p(S,{class:"text-body1",style:{"font-size":"25px"}},{default:h(()=>[p(L,null,{default:h(()=>n[3]||(n[3]=[C("Choose a subscription plan")])),_:1}),p(L,{caption:""},{default:h(()=>n[4]||(n[4]=[C("During the free trial or the subscription, you can cancel the subscription at any time.")])),_:1})]),_:1})]),_:1}),c.isPricesLoading?(x(),q("div",ht,[p(X,{size:"md",color:"primary"}),n[5]||(n[5]=z("div",{class:"q-mt-md"},"Loading Subscription Plans ...",-1))])):(x(),q(W,{key:1},[p(oe,{bordered:"",separator:"",padding:""},{default:h(()=>[(x(!0),q(W,null,Ue(c.paddlePrices,(f,m)=>(x(),ke(N,{key:m,tag:"label",class:se(f.id==c.selectedPriceId?"text-primary text-bold":""),clickable:""},{default:h(()=>[p(S,{avatar:""},{default:h(()=>[p(Ne,{modelValue:c.selectedPriceId,"onUpdate:modelValue":n[0]||(n[0]=g=>c.selectedPriceId=g),val:f.id},null,8,["modelValue","val"])]),_:2},1024),p(S,null,{default:h(()=>[p(L,null,{default:h(()=>[C($(f.name),1)]),_:2},1024),p(L,{class:se(f.id==c.selectedPriceId?"text-primary":""),caption:""},{default:h(()=>[C($(f.description),1)]),_:2},1032,["class"])]),_:2},1024),p(S,{avatar:""},{default:h(()=>[p(L,null,{default:h(()=>[C($(f.total),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1}),p(N,{class:"q-pa-none q-my-md"},{default:h(()=>[p(S,null,{default:h(()=>[p(ce,{disabled:!u.isPaddleInitialized,loading:c.isCheckoutLoading,onClick:u.subscribeNow,label:"Subscribe Now",color:"white",class:"bg-positive",style:{"min-height":"50px"},flat:"",stretch:"","no-caps":""},{loading:h(()=>[p(X,{size:"sm"})]),_:1},8,["disabled","loading","onClick"])]),_:1})]),_:1}),p(N,{class:"q-pa-none q-mt-md"},{default:h(()=>[p(S,null,{default:h(()=>[p(ce,{label:"Back",style:{"min-height":"50px"},onClick:n[1]||(n[1]=f=>e.$router.go(-1)),flat:"",stretch:"","no-caps":""})]),_:1})]),_:1})],64))]),_:1}),p(qe,{showing:c.isVerifyingSubs,style:{"background-color":"rgba(255,255,255,0.8)"},color:"primary",label:"Please wait..."},{default:h(()=>[z("div",null,[p(X,{color:"primary",size:"md"})]),n[6]||(n[6]=z("div",{class:"q-mt-md text-primary text-h6"}," Verifying your subscription... ",-1))]),_:1},8,["showing"])],64)}const Et=Te(ft,[["render",yt],["__scopeId","data-v-f8487c9c"]]);export{Et as default};
